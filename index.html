<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpeakUp AI - AI ì˜ì–´ íšŒí™” íŠœí„°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="./style.css">
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
        }
    </style>
    <script src="./config.js"></script>
</head>
<body class="flex flex-col items-center justify-center min-h-screen gradient-bg p-2 sm:p-4">

    <div class="bg-white w-full max-w-2xl rounded-2xl shadow-2xl flex flex-col" style="height: calc(100vh - 30px); max-height: 800px;">
        <header class="header-bg text-white p-4 sm:p-5 rounded-t-2xl flex flex-wrap items-center justify-between relative shadow-md">
            <div class="flex items-center order-2 sm:order-1">
                <div class="relative" id="scenarioPickerContainer">
                    <button id="scenarioPickerButton" class="flex items-center text-sm sm:text-base bg-sky-700 hover:bg-sky-600 px-3 py-1.5 sm:px-4 sm:py-2 rounded-lg transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-sky-400">
                        <span id="currentScenarioDisplay">ì‹œë‚˜ë¦¬ì˜¤</span>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 ml-1.5 opacity-80"> <path fillRule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clipRule="evenodd" /> </svg>
                    </button>
                    <div id="scenarioDropdown" class="hidden absolute left-0 mt-2 w-72 sm:w-80 bg-white rounded-lg shadow-xl z-20 border border-slate-200 max-h-96 overflow-y-auto custom-scrollbar fade-in">
                        </div>
                </div>
            </div>
            <h1 id="headerTitle" class="order-first w-full sm:order-2 sm:w-auto text-xl sm:text-2xl font-semibold text-center truncate sm:flex-1 sm:mx-4" title="SpeakUp AI">SpeakUp AI</h1>
            <div class="flex items-center space-x-2 order-3 sm:order-3">
                <div class="relative" id="languagePickerContainer">
                    <button id="languagePickerButton" class="flex items-center text-xs sm:text-sm bg-sky-700 hover:bg-sky-600 px-2 py-1 sm:px-2 sm:py-1.5 rounded-lg transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-sky-400">
                        <span id="currentLanguageDisplay">í•œêµ­ì–´</span>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 ml-1.5 opacity-80"> <path fillRule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clipRule="evenodd" /> </svg>
                    </button>
                    <div id="languageDropdown" class="hidden absolute right-0 mt-2 w-28 bg-white rounded-lg shadow-xl z-20 border border-slate-200 max-h-96 overflow-y-auto custom-scrollbar fade-in">
                        <div class="py-1">
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-lang="ko">í•œêµ­ì–´</a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-lang="ja">æ—¥æœ¬èª</a>
                        </div>
                    </div>
                </div>
                <button id="helpButton" title="ë„ì›€ë§ ë³´ê¸°" class="text-sm sm:text-base bg-sky-700 hover:bg-sky-600 p-2 sm:p-2.5 rounded-lg transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-sky-400">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z" />
                    </svg>
                </button>
                <button id="newConversationButton" title="ìƒˆ ëŒ€í™” ì‹œì‘" class="text-sm sm:text-base bg-sky-700 hover:bg-sky-600 p-2 sm:p-2.5 rounded-lg transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-sky-400">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"> <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" /> </svg>
                </button>
                <div class="relative" id="jsonMenuContainer">
                    <button id="jsonMenuButton" title="ëŒ€í™” ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸°" class="text-sm sm:text-base bg-sky-700 hover:bg-sky-600 p-2 sm:p-2.5 rounded-lg transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-sky-400">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
                        </svg>
                    </button>
                    <div id="jsonMenuDropdown" class="hidden absolute right-0 mt-2 w-40 bg-white rounded-lg shadow-xl z-20 border border-slate-200 fade-in">
                        <div class="py-1">
                            <a href="#" id="jsonMenuSave" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 inline mr-2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 16v-8m0 8l3-3m-3 3l-3-3m6 0a6 6 0 11-12 0 6 6 0 0112 0z" />
                                </svg>
                                ëŒ€í™” ì €ì¥
                            </a>
                            <a href="#" id="jsonMenuLoad" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 inline mr-2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v8m0-8l3 3m-3-3l-3 3m6 0a6 6 0 11-12 0 6 6 0 0112 0z" />
                                </svg>
                                ëŒ€í™” ë¶ˆëŸ¬ì˜¤ê¸°
                            </a>
                        </div>
                    </div>
                </div>
                <div class="relative" id="savedDataMenuContainer">
                    <button id="savedDataMenuButton" title="ì €ì¥ëœ ë°ì´í„° ë³´ê¸°" class="text-sm sm:text-base bg-sky-700 hover:bg-sky-600 p-2 sm:p-2.5 rounded-lg transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-sky-400">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z" />
                        </svg>
                    </button>
                    <div id="savedDataMenuDropdown" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl z-20 border border-slate-200 fade-in">
                        <div class="py-1">
                            <a href="#" id="savedDataMenuFavorites" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4 inline mr-2">
                                    <path d="M11.48 3.5a.75.75 0 011.04 0l2.42 2.45 3.4.53a.75.75 0 01.42 1.28l-2.46 2.43.58 3.38a.75.75 0 01-1.08.79L12 13.34l-3.38 1.42a.75.75 0 01-1.08-.79l.58-3.38L5.66 8.26a.75.75 0 01.42-1.28l3.4-.53 2.42-2.45z" />
                                </svg>
                                ì¦ê²¨ì°¾ê¸° ëª¨ì•„ë³´ê¸°
                            </a>
                            <a href="#" id="savedDataMenuAnalyses" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 inline mr-2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
                                </svg>
                                ì €ì¥ëœ ë¶„ì„ ë³´ê¸°
                            </a>
                        </div>
                    </div>
                </div>
                <input type="file" id="importJsonInput" accept="application/json" class="hidden" />
            </div>
        </header>

        <div id="scenarioDescriptionArea" class="p-4 sm:p-5 border-b border-slate-200 bg-slate-50">
            <h2 id="scenarioTitle" class="text-lg sm:text-xl font-semibold text-sky-700 mb-1.5">ì‹œë‚˜ë¦¬ì˜¤ ì œëª©</h2>
            <p id="scenarioDescription" class="text-sm text-slate-600 mb-3 leading-relaxed hide-after-conversation-start">ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª…</p>
            <div id="starterPhrasesContainer" class="mt-2 mb-3 hidden hide-after-conversation-start">
                <p class="text-xs font-semibold text-sky-600 mb-1.5">ì´ë ‡ê²Œ ì‹œì‘í•´ ë³´ì„¸ìš”:</p>
                <div id="starterPhrases" class="flex flex-wrap gap-2">
                    </div>
            </div>
            <div id="focusTopicGroup" class="hide-after-conversation-start">
                 <input type="text" id="focusTopicInput" placeholder="ì§‘ì¤‘ ì—°ìŠµ ì£¼ì œ (ì„ íƒ ì‚¬í•­)" class="w-full p-2 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition-shadow"/>
            </div>
            <div id="customScenarioGroup" class="hidden hide-after-conversation-start">
                <textarea id="customScenarioInput" placeholder="ì—°ìŠµí•˜ê³  ì‹¶ì€ ìƒí™©ì´ë‚˜ ëŒ€í™” ì£¼ì œë¥¼ ìì„¸íˆ ì…ë ¥í•´ì£¼ì„¸ìš”..." class="w-full p-2 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition-shadow" rows="3"></textarea>
            </div>
        </div>

        <div id="messagesContainer" class="flex-grow p-4 sm:p-5 overflow-y-auto chat-bg space-y-4 custom-scrollbar">
            </div>

        <div class="p-4 sm:p-5 border-t border-slate-200 input-area-bg">
            <div class="flex items-center space-x-3 mb-3">
                <input type="text" id="userInput" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." class="flex-grow p-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-sky-500 focus:border-sky-500 outline-none transition-shadow text-base shadow-sm"/>
                <button id="sendMessageButton" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold p-3 rounded-xl transition-all duration-150 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center shadow-md hover:shadow-lg btn-glow-blue focus:outline-none focus:ring-2 focus:ring-blue-300">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-6 h-6"> <path d="M3.5 2.75a.75.75 0 00-1.061.645l1.906 11.438a.75.75 0 001.412-.001L7.25 9.086l5.438-4.078a.75.75 0 00-.816-1.299L4.06 7.354 3.5 2.75zM2.75 16.5a.75.75 0 001.061.645l12.626-7.575a.75.75 0 000-1.29l-12.626-7.575A.75.75 0 002.75 1.5v15z" /> </svg>
                </button>
            </div>

            <div id="suggestedRepliesContainer" class="mb-2.5 p-2.5 bg-sky-50 rounded-lg hidden shadow fade-in">
                <h4 class="text-xs font-semibold text-sky-700 mb-1.5">AI ì‘ë‹µ ì œì•ˆ:</h4>
                <ul id="suggestedRepliesList" class="space-y-1.5">
                    </ul>
            </div>

            <div class="flex space-x-2">
                <button id="suggestRepliesButton" class="compact-button bg-amber-400 hover:bg-amber-500 text-amber-900 font-semibold rounded-lg transition-all duration-150 ease-in-out disabled:opacity-60 flex items-center justify-center shadow hover:shadow-md btn-secondary-glow focus:outline-none focus:ring-2 focus:ring-amber-300 flex-1">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4"> <path fillRule="evenodd" d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.39-3.423 3.352c-.772.753-.235 2.047.788 2.225l4.21.728 1.948 4.24c.322.772 1.416.772 1.737 0l1.947-4.24 4.21-.728c1.023-.178 1.56-1.472.788-2.225l-3.423-3.352-4.753-.39-1.83-4.401zM12.267 8.197L10 12.488l-2.267-4.291-4.573-.374 3.29-3.218-1.043-4.493 4.065 1.956L10 0l2.528 1.978 4.065-1.956-1.043 4.493 3.29 3.218-4.573.374z" clipRule="evenodd" /> </svg>
                    <span id="suggestRepliesButtonText">ì‘ë‹µ ì œì•ˆ</span>
                </button>
                <button id="analyzeSentenceButton" class="compact-button bg-teal-500 hover:bg-teal-600 text-white font-semibold rounded-lg transition-all duration-150 ease-in-out disabled:opacity-60 flex items-center justify-center shadow-md hover:shadow-lg btn-tertiary-glow focus:outline-none focus:ring-2 focus:ring-teal-300 flex-1">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4"> <path fillRule="evenodd" d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.39-3.423 3.352c-.772.753-.235 2.047.788 2.225l4.21.728 1.948 4.24c.322.772 1.416.772 1.737 0l1.947-4.24 4.21-.728c1.023-.178 1.56-1.472.788-2.225l-3.423-3.352-4.753-.39-1.83-4.401zM12.267 8.197L10 12.488l-2.267-4.291-4.573-.374 3.29-3.218-1.043-4.493 4.065 1.956L10 0l2.528 1.978 4.065-1.956-1.043 4.493 3.29 3.218-4.573.374z" clipRule="evenodd" /> </svg>
                    <span id="analyzeSentenceButtonText">ë¬¸ì¥ ë¶„ì„</span>
                </button>
                <button id="roleSwapButton" class="compact-button bg-indigo-500 hover:bg-indigo-600 text-white font-semibold rounded-lg transition-all duration-150 ease-in-out disabled:opacity-60 flex items-center justify-center shadow-md hover:shadow-lg btn-glow-indigo focus:outline-none focus:ring-2 focus:ring-indigo-300 flex-1">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M7.5 21 3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5" />
                    </svg>
                    <span id="roleSwapButtonText">ì—­í•  ë³€ê²½</span>
                </button>
            </div>
        </div>
    </div>

    <div id="guideModal" class="hidden fixed inset-0 modal-bg-overlay flex items-center justify-center p-4 z-50 fade-in">
        <div id="guideModalContent" class="bg-white p-6 sm:p-8 rounded-xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto custom-scrollbar">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl sm:text-2xl font-bold text-sky-600">SpeakUp AI ì‚¬ìš© ê°€ì´ë“œ ğŸš€</h2>
                <button id="closeGuideModalButton" class="text-slate-400 hover:text-slate-600 text-3xl transition-colors">Ã—</button>
            </div>
            <div class="space-y-3 text-sm sm:text-base text-slate-700">
                <p><strong>1. ğŸ¤– ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ:</strong><br/> í™”ë©´ ì¢Œì¸¡ ìƒë‹¨ì˜ í˜„ì¬ ì‹œë‚˜ë¦¬ì˜¤ ë²„íŠ¼ (ì˜ˆ: <span class="font-semibold text-sky-600">ì¹´í˜ì—ì„œ</span>)ì„ í´ë¦­í•˜ì„¸ìš”. ë‹¤ì–‘í•œ ì¹´í…Œê³ ë¦¬ë³„ ëŒ€í™” ìƒí™©ì„ ì„ íƒí•˜ê±°ë‚˜, 'âœ¨ ì‚¬ìš©ì ì„¤ì •'ì„ í†µí•´ ì§ì ‘ ì›í•˜ëŠ” ì£¼ì œë¥¼ ì…ë ¥í•˜ì—¬ ì—°ìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                <p><strong>2. ğŸ¯ ì§‘ì¤‘ ì£¼ì œ (ì„ íƒ ì‚¬í•­):</strong><br/> ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª… ì•„ë˜ì— ìˆëŠ” ì…ë ¥ì°½ì— íŠ¹ë³„íˆ ì—°ìŠµí•˜ê³  ì‹¶ì€ ì–´íœ˜ë‚˜ í‘œí˜„ ë“±ì„ ì…ë ¥í•˜ë©´ AIê°€ ëŒ€í™”ì— ë” ì˜ ë°˜ì˜í•´ì¤ë‹ˆë‹¤. (ì‚¬ìš©ì ì„¤ì • ì‹œë‚˜ë¦¬ì˜¤ì—ì„œëŠ” ì´ ì…ë ¥ì°½ì´ ì—†ìŠµë‹ˆë‹¤.)</p>
                <p><strong>3. ğŸ—£ï¸ ëŒ€í™” ì‹œì‘í•˜ê¸°:</strong><br/> í™”ë©´ ìƒë‹¨ì— í˜„ì¬ ì‹œë‚˜ë¦¬ì˜¤ì— ë§ëŠ” <span class="text-sky-600 font-medium">"ì´ë ‡ê²Œ ì‹œì‘í•´ ë³´ì„¸ìš”:"</span> ì˜ˆì‹œ ë¬¸ì¥ë“¤ì´ ì œê³µë©ë‹ˆë‹¤. í´ë¦­í•˜ë©´ ë°”ë¡œ ì…ë ¥ì°½ì— ì ìš©ë¼ìš”! ë˜ëŠ” ì§ì ‘ ì˜ì–´ë¡œ ë©”ì‹œì§€ë¥¼ ì‘ì„±í•˜ê³  ì „ì†¡ (ì¢…ì´ë¹„í–‰ê¸° ì•„ì´ì½˜) ë²„íŠ¼ì„ ëˆŒëŸ¬ AI íŠœí„°ì™€ ëŒ€í™”ë¥¼ ì‹œì‘í•˜ì„¸ìš”.</p>
                <p><strong>4. âœ¨ AI ê¸°ëŠ¥ í™œìš©í•˜ê¸° (ì…ë ¥ì°½ í•˜ë‹¨ ë²„íŠ¼):</strong></p>
                <ul class="list-disc list-inside pl-4 space-y-1">
                    <li><strong class="text-amber-600">ì‘ë‹µ ì œì•ˆ:</strong> ëŒ€í™” ì¤‘ ì–´ë–¤ ë§ì„ í•´ì•¼ í• ì§€ ë§‰ë§‰í•  ë•Œ ëˆ„ë¥´ë©´, AIê°€ 3ê°€ì§€ ì‘ë‹µ ì˜ˆì‹œë¥¼ ì¶”ì²œí•´ì¤ë‹ˆë‹¤.</li>
                    <li><strong class="text-teal-600">ë¬¸ì¥ ë¶„ì„:</strong> ë°©ê¸ˆ ë‚´ê°€ ë³´ë‚¸ ì˜ì–´ ë¬¸ì¥ì— ëŒ€í•´ AIê°€ ë¬¸ë²•, ì–´íœ˜, ìì—°ìŠ¤ëŸ¬ì›€ ë“±ì„ ë¶„ì„í•˜ê³ , <span class="text-sky-600">í•œêµ­ì–´ ìš”ì•½</span>ë„ í•¨ê»˜ ì œê³µí•©ë‹ˆë‹¤.</li>
                    <li><strong class="text-indigo-600">ì—­í•  ë³€ê²½:</strong> í˜„ì¬ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ì‚¬ìš©ìì™€ AIì˜ ì—­í• ì„ ì„œë¡œ ë°”ê¿‰ë‹ˆë‹¤. (ì˜ˆ: ì†ë‹˜ â†” ì ì›) ì—­í• ì´ ë°”ë€Œë©´ ìƒˆë¡œìš´ ì‹œì‘ í‘œí˜„ë„ ì œê³µë©ë‹ˆë‹¤.</li>
                </ul>
                <p><strong>5. ğŸ”„ ìƒˆ ëŒ€í™” ì‹œì‘:</strong><br/> í™”ë©´ ìš°ì¸¡ ìƒë‹¨ì˜ ìƒˆë¡œê³ ì¹¨ ì•„ì´ì½˜ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´, í˜„ì¬ ì„ íƒëœ ì‹œë‚˜ë¦¬ì˜¤ (ë˜ëŠ” ì‚¬ìš©ì ì„¤ì • ì£¼ì œ) ë° ì—­í• ë¡œ ëŒ€í™” ë‚´ìš©ì„ ì´ˆê¸°í™”í•˜ê³  ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì—°ìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            </div>
            <button id="confirmGuideModalButton" class="mt-6 w-full bg-sky-600 hover:bg-sky-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-sky-400">
                ì•Œê² ìŠµë‹ˆë‹¤!
            </button>
        </div>
    </div>

    <div id="analysisModal" class="hidden fixed inset-0 modal-bg-overlay flex items-center justify-center p-4 z-50 fade-in">
        <div id="analysisModalContent" class="bg-white p-6 sm:p-8 rounded-xl shadow-2xl max-w-lg w-full max-h-[85vh] overflow-y-auto custom-scrollbar">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl sm:text-2xl font-semibold text-sky-700">âœ¨ ë‚´ ë¬¸ì¥ ë¶„ì„ ê²°ê³¼</h3>
                <button id="closeAnalysisModalButtonFromAnalysis" class="text-slate-400 hover:text-slate-600 text-3xl transition-colors">Ã—</button>
            </div>
            <div id="englishAnalysisResult" class="mb-5">
                <h4 class="text-lg font-medium text-slate-800 mb-1.5">ğŸ“ ì˜ì–´ í”¼ë“œë°±:</h4>
                <div class="text-base text-slate-700 whitespace-pre-wrap leading-relaxed p-3 bg-slate-50 rounded-md border border-slate-200"></div>
            </div>
            <div id="koreanAnalysisResult">
                <h4 class="text-lg font-medium text-slate-800 mb-1.5">ğŸ‡°ğŸ‡· í•œêµ­ì–´ ìš”ì•½:</h4>
                <div class="text-base text-slate-700 whitespace-pre-wrap leading-relaxed p-3 bg-sky-50 rounded-md border border-sky-200"></div>
            </div>
            <div class="mt-6 flex space-x-3">
                <button id="saveAnalysisButton" class="flex-1 bg-teal-600 hover:bg-teal-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-teal-400">
                    ğŸ“š ë¶„ì„ ì €ì¥
                </button>
                <button id="confirmAnalysisModalButtonFromAnalysis" class="flex-1 bg-sky-600 hover:bg-sky-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-sky-400">
                    í™•ì¸í–ˆì–´ìš”!
                </button>
            </div>
        </div>
    </div>

    <div id="favoritesModal" class="hidden fixed inset-0 modal-bg-overlay flex items-center justify-center p-4 z-50 fade-in">
        <div id="favoritesModalContent" class="bg-white p-6 sm:p-8 rounded-xl shadow-2xl max-w-lg w-full max-h-[85vh] overflow-y-auto custom-scrollbar">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl sm:text-2xl font-semibold text-sky-700">â­ ì¦ê²¨ì°¾ì€ ë¬¸ì¥</h3>
                <button id="closeFavoritesModalButton" class="text-slate-400 hover:text-slate-600 text-3xl transition-colors">Ã—</button>
            </div>
            <div id="favoritesList" class="space-y-2 text-base text-slate-700"></div>
            <button id="confirmFavoritesModalButton" class="mt-6 w-full bg-sky-600 hover:bg-sky-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-sky-400">
                í™•ì¸í–ˆì–´ìš”!
            </button>
        </div>
    </div>

    <div id="savedAnalysesModal" class="hidden fixed inset-0 modal-bg-overlay flex items-center justify-center p-4 z-50 fade-in">
        <div id="savedAnalysesModalContent" class="bg-white p-6 sm:p-8 rounded-xl shadow-2xl max-w-2xl w-full max-h-[85vh] overflow-y-auto custom-scrollbar">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl sm:text-2xl font-semibold text-sky-700">ğŸ“š ì €ì¥ëœ ë¬¸ì¥ ë¶„ì„</h3>
                <button id="closeSavedAnalysesModalButton" class="text-slate-400 hover:text-slate-600 text-3xl transition-colors">Ã—</button>
            </div>
            <div id="savedAnalysesList" class="space-y-4 text-base text-slate-700"></div>
            <button id="confirmSavedAnalysesModalButton" class="mt-6 w-full bg-sky-600 hover:bg-sky-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-sky-400">
                í™•ì¸í–ˆì–´ìš”!
            </button>
        </div>
    </div>

    <script>
// í•œêµ­ì–´ ì–¸ì–´ ë°ì´í„°
const ko_SCENARIO_DATA = [
    { category: "ì¼ìƒ ìƒí™œ (Everyday Life)", items: [
        { id: "cafe", title: "ì¹´í˜ì—ì„œ ì£¼ë¬¸í•˜ê¸° â˜•", description: "ë°”ë¦¬ìŠ¤íƒ€ì—ê²Œ ì»¤í”¼ë¥¼ ì£¼ë¬¸í•˜ê³  ê°„ë‹¨í•œ ìš”ì²­ì„ í•´ë³´ì„¸ìš”. AIëŠ” ì¹œì ˆí•œ ë°”ë¦¬ìŠ¤íƒ€ ì—­í• ì„ í•©ë‹ˆë‹¤.",
          baseContext: "You are a friendly barista. The user is ordering coffee. Respond concisely (1-2 sentences), ask one question at a time if necessary, and assist with their order. Do not ask questions you've already received answers for.",
          baseContext_swapped: "You are a customer ordering coffee. The user is the barista. Make your order and ask any questions you might have. Keep your requests concise.",
          starters_userAsPrimary: ["Hi, can I get a latte?", "Hello! What do you recommend?", "I'd like to order a coffee, please."],
          starters_userAsOther: ["Hi there! What can I get for you today?", "Welcome! Ready to order?", "Hello! How can I help you?"] },
        { id: "grocery_shopping", title: "ì‹ë£Œí’ˆì ì—ì„œ ì¥ë³´ê¸° ğŸ›’", description: "ì ì›ì—ê²Œ ë¬¼ê±´ ìœ„ì¹˜ë¥¼ ë¬»ê±°ë‚˜ ê³„ì‚°í•  ë•Œ ëŒ€í™”í•´ë³´ì„¸ìš”. AIëŠ” ì¹œì ˆí•œ ì ì› ì—­í• ì„ í•©ë‹ˆë‹¤.",
          baseContext: "You are a helpful grocery store clerk. The user is shopping. Respond concisely (1-2 sentences) and help them find items or checkout. Ask one question at a time if needed. Do not ask questions you've already received answers for.",
          baseContext_swapped: "You are a customer at a grocery store. The user is the clerk. Ask for help or proceed to checkout concisely.",
          starters_userAsPrimary: ["Excuse me, where can I find the milk?", "How much is this?", "I'd like to pay for these items."],
          starters_userAsOther: ["Hi! Can I help you find something?", "Are you ready to check out?", "Did you find everything okay?"] },
        { id: "making_appointments", title: "ì˜ˆì•½í•˜ê¸° (ë¯¸ìš©ì‹¤, ë³‘ì› ë“±) ğŸ—“ï¸", description: "ì „í™”ë‚˜ ë°©ë¬¸ì„ í†µí•´ ì˜ˆì•½í•˜ëŠ” ìƒí™©ì„ ì—°ìŠµí•©ë‹ˆë‹¤. AIëŠ” ì ‘ìˆ˜ì› ì—­í• ì„ í•©ë‹ˆë‹¤.",
          baseContext: "You are a receptionist at a salon/clinic. The user wants to make an appointment. Guide them concisely (1-2 sentences per turn), asking one question at a time for preferences and confirming details. Do not ask questions you've already received answers for.",
          baseContext_swapped: "You want to make an appointment. The user is the receptionist. State your needs concisely.",
          starters_userAsPrimary: ["I'd like to make an appointment for a haircut.", "Do you have any openings next Tuesday?", "Can I book a check-up for this week?"],
          starters_userAsOther: ["Hello, [Salon/Clinic Name], how can I help you?", "Good morning! How may I assist you with scheduling?", "Are you looking to book an appointment?"] },
        { id: "daily_routine_talk", title: "ì¼ìƒ ì´ì•¼ê¸°í•˜ê¸° â˜€ï¸", description: "í•˜ë£¨ ì¼ê³¼ë‚˜ ì£¼ë§ ê³„íš ë“± ì¼ìƒì ì¸ ì£¼ì œë¡œ ëŒ€í™”í•©ë‹ˆë‹¤. AIëŠ” ì¹œêµ¬ ì—­í• ì„ í•©ë‹ˆë‹¤.",
          baseContext: "You are a friend. The user wants to talk about daily life. Engage in a casual, concise (1-2 sentences per turn) conversation. Ask one question at a time if needed. Do not ask questions you've already received answers for.",
          baseContext_swapped: "You are talking to a friend (the user). Share something about your day or ask about theirs, keeping it concise.",
          starters_userAsPrimary: ["How was your day?", "What are you up to this weekend?", "I usually [activity] in the morning."],
          starters_userAsOther: ["Hey! What's new?", "How's it going?", "Anything interesting happen today?"] },
        { id: "public_transportation", title: "ëŒ€ì¤‘êµí†µ ì´ìš©í•˜ê¸° ğŸšŒ", description: "ë²„ìŠ¤ë‚˜ ì§€í•˜ì²  í‘œë¥¼ ì‚¬ê±°ë‚˜ ê¸¸ì„ ë¬»ëŠ” ìƒí™©ì…ë‹ˆë‹¤. AIëŠ” ì—­ë¬´ì› ë˜ëŠ” ë‹¤ë¥¸ ìŠ¹ê° ì—­í• ì„ í•©ë‹ˆë‹¤.",
          baseContext: "You are a public transport staff or a helpful passenger. The user needs help. Provide clear, concise (1-2 sentences per turn) assistance. Ask one question at a time if needed. Do not ask questions you've already received answers for.",
          baseContext_swapped: "You need help with public transport. The user is staff/passenger. Ask your question concisely.",
          starters_userAsPrimary: ["Which bus goes to downtown?", "How much is a single ride ticket?", "Is this the platform for the express train?"],
          starters_userAsOther: ["Can I help you with something?", "Are you looking for a specific line?", "Tickets can be purchased over there."] }
    ]},
    { category: "ì—¬í–‰ (Travel)", items: [
        { id: "airport_checkin", title: "ê³µí•­ ì²´í¬ì¸ âœˆï¸", description: "ê³µí•­ ì²´í¬ì¸ ì¹´ìš´í„°ì—ì„œ íƒ‘ìŠ¹ ìˆ˜ì†ì„ ì§„í–‰í•©ë‹ˆë‹¤.", baseContext: "You are an airline check-in agent. The user is checking in for a flight. Ask for passport/ticket, discuss baggage, seat preferences. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You are at the airport checking in for your flight. The user is the check-in agent. Provide your documents and discuss your flight details concisely.", starters_userAsPrimary: ["I'd like to check in for my flight to London.", "Here's my passport and ticket.", "Can I have a window seat, please?"], starters_userAsOther: ["Good [morning/afternoon/evening]! May I see your passport and ticket, please?", "Where are you flying to today?", "Do you have any bags to check in?"] },
        { id: "hotel_checkin", title: "í˜¸í…” ì²´í¬ì¸ ğŸ¨", description: "í˜¸í…” í”„ë¡ íŠ¸ì—ì„œ ì˜ˆì•½ í™•ì¸ ë° ì²´í¬ì¸ì„ í•©ë‹ˆë‹¤.", baseContext: "You are a hotel receptionist. The user is checking in. Confirm reservation, explain amenities, answer questions. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You are checking into a hotel. The user is the receptionist. Provide your reservation details and ask any necessary questions concisely.", starters_userAsPrimary: ["I have a reservation under the name [Your Name].", "Could you tell me what time breakfast is served?", "Is there Wi-Fi in the room?"], starters_userAsOther: ["Welcome to our hotel! How can I help you?", "Do you have a reservation with us?", "May I have your name, please?"] },
        { id: "asking_directions", title: "ê¸¸ ë¬»ê¸° ğŸ—ºï¸", description: "ì—¬í–‰ ì¤‘ ëª¨ë¥´ëŠ” ê³³ì—ì„œ ê¸¸ì„ ë¬»ëŠ” ìƒí™©ì…ë‹ˆë‹¤.", baseContext: "You are a local resident. The user is a tourist asking for directions. Provide clear, concise (1-2 sentences) instructions and be helpful. Ask one question at a time if needed.", baseContext_swapped:"You are a tourist asking for directions. The user is a local resident. Ask for help finding your way concisely.", starters_userAsPrimary: ["Excuse me, how can I get to the museum?", "Could you show me on the map?", "Is this the right way to the train station?"], starters_userAsOther: ["Yes, how can I help you?", "Where are you trying to go?", "Sure, I can help with that."] },
        { id: "ordering_at_restaurant_travel", title: "ì—¬í–‰ ì¤‘ ì‹ë‹¹ ì£¼ë¬¸ ğŸ½ï¸", description: "ì—¬í–‰ì§€ ì‹ë‹¹ì—ì„œ ìŒì‹ì„ ì£¼ë¬¸í•˜ê³  í˜„ì§€ ìŒì‹ì— ëŒ€í•´ ì§ˆë¬¸í•©ë‹ˆë‹¤.", baseContext: "You are a waiter/waitress in a tourist-friendly restaurant. The user is ordering food and might ask about local specialties. Be patient and helpful. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You are a customer at a restaurant in a tourist area. The user is the waiter/waitress. Order food and ask about the menu concisely.", starters_userAsPrimary: ["What's the local specialty here?", "I'd like to try something traditional.", "Can you recommend a dish?"], starters_userAsOther: ["Welcome! Are you ready to order, or do you need a few more minutes?", "Can I get you started with something to drink?", "What can I get for you?"] },
        { id: "booking_tour", title: "ì—¬í–‰ ìƒí’ˆ ì˜ˆì•½í•˜ê¸° ğŸï¸", description: "í˜„ì§€ íˆ¬ì–´ë‚˜ ì•¡í‹°ë¹„í‹°ë¥¼ ì˜ˆì•½í•˜ëŠ” ìƒí™©ì…ë‹ˆë‹¤.", baseContext: "You are a travel agent or tour operator. The user wants to book a tour or activity. Provide information about options, prices, and make the booking. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You want to book a local tour or activity. The user is the travel agent. Inquire about options and make a booking concisely.", starters_userAsPrimary: ["I'm interested in booking a city tour.", "What kind of tours do you offer?", "How much does the [tour name] cost?"], starters_userAsOther: ["Hello! How can I help you plan your activities today?", "We have several tours available. What are you interested in?", "Certainly, let me check the availability for you."] },
        { id: "at_immigration", title: "ì…êµ­ ì‹¬ì‚¬ëŒ€ì—ì„œ ğŸ›‚", description: "ê³µí•­ ì…êµ­ ì‹¬ì‚¬ëŒ€ì—ì„œ ì‹¬ì‚¬ê´€ì˜ ì§ˆë¬¸ì— ë‹µë³€í•©ë‹ˆë‹¤.", baseContext: "You are an immigration officer. The user is arriving in the country. Ask about the purpose of their visit, length of stay, and check their documents. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You are at immigration control upon arriving in a new country. The user is the immigration officer. Answer their questions about your visit concisely.", starters_userAsPrimary: ["Good morning. May I see your passport?", "What is the purpose of your visit?", "How long do you plan to stay?"], starters_userAsOther: ["Next, please. Passport and landing card.", "Good [morning/afternoon]. Welcome to [Country].", "What is the purpose of your visit to [Country]?"] }
    ]},
    { category: "ì§ì¥ ìƒí™œ (Work & Business)", items: [
        { id: "job_interview", title: "ë©´ì ‘ ë³´ê¸° ğŸ’¼", description: "êµ¬ì§ ë©´ì ‘ ìƒí™©ì„ ì—°ìŠµí•©ë‹ˆë‹¤. ìê¸°ì†Œê°œ, ì§ˆë¬¸ ë‹µë³€ ë“±", baseContext: "You are an interviewer for a job position. The user is a candidate. Ask common interview questions and evaluate their responses in English. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You are a candidate at a job interview. The user is the interviewer. Answer questions about your qualifications and experience concisely.", starters_userAsPrimary: ["Tell me about yourself.", "Why are you interested in this position?", "What are your strengths?"], starters_userAsOther: ["Thank you for coming in today. Please, have a seat.", "So, tell me a little bit about yourself.", "Why are you interested in this role at our company?"] },
        { id: "meeting_colleagues", title: "ë™ë£Œì™€ íšŒì˜í•˜ê¸° ğŸ‘¥", description: "ì—…ë¬´ ê´€ë ¨ íšŒì˜ì—ì„œ ì˜ê²¬ì„ ì œì‹œí•˜ê³  í† ë¡ í•©ë‹ˆë‹¤.", baseContext: "You are a colleague in a business meeting. The user is participating in the meeting. Discuss agenda items, share opinions, and collaborate. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You are participating in a business meeting with colleagues. The user is one of your colleagues. Share your opinions and discuss agenda items concisely.", starters_userAsPrimary: ["I'd like to suggest an idea.", "What are your thoughts on this proposal?", "Let's discuss the next steps."], starters_userAsOther: ["Okay team, let's get started. The first item on the agenda is...", "Does anyone have any initial thoughts on this?", "Thanks for sharing, [User's Name]. What does everyone else think?"] },
        { id: "phone_call_business", title: "ì—…ë¬´ ì „í™” í†µí™” ğŸ“", description: "ë¹„ì¦ˆë‹ˆìŠ¤ ëª©ì ìœ¼ë¡œ ì „í™”ë¥¼ ê±¸ê±°ë‚˜ ë°›ëŠ” ìƒí™©ì…ë‹ˆë‹¤.", baseContext: "You are a business professional on a phone call. The user is either initiating or receiving a business call. Handle inquiries, schedule meetings, or discuss projects professionally. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You are making or receiving a business phone call. The user is the other party. Discuss professional matters, schedule appointments, or make inquiries concisely.", starters_userAsPrimary: ["Hello, this is [Your Name] from [Your Company].", "May I speak to Mr./Ms. [Name]?", "I'm calling to inquire about..."], starters_userAsOther: ["Good morning, [Company Name], [Your Name] speaking. How can I help you?", "Hello, thank you for calling. This is [Your Name].", "[User's Name] speaking."] },
        { id: "presentation_qna", title: "ë°œí‘œ í›„ ì§ˆì˜ì‘ë‹µ ğŸ¤", description: "ë°œí‘œë¥¼ ë§ˆì¹œ í›„ ì²­ì¤‘ì˜ ì§ˆë¬¸ì— ë‹µë³€í•˜ëŠ” ìƒí™©ì…ë‹ˆë‹¤.", baseContext: "You are an audience member after a presentation. The user is the presenter. Ask relevant questions about their presentation. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You are the presenter who has just finished a presentation. The user is an audience member asking questions. Answer their questions clearly and concisely.", starters_userAsPrimary: ["Thank you for your presentation. I have a question about...", "Could you elaborate on [specific point]?", "What are the implications of your findings?"], starters_userAsOther: ["Thank you for that insightful presentation. We now have some time for questions.", "Any questions for our speaker?", "Yes, the person in the back?"] },
        { id: "networking_event", title: "ë„¤íŠ¸ì›Œí‚¹ í–‰ì‚¬ ğŸ¤", description: "ì—…ê³„ í–‰ì‚¬ì—ì„œ ìƒˆë¡œìš´ ì‚¬ëŒë“¤ê³¼ êµë¥˜í•˜ë©° ëŒ€í™”í•©ë‹ˆë‹¤.", baseContext: "You are attending a networking event. The user is also an attendee. Initiate or respond to conversations to build professional connections. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You are attending a networking event. The user is another attendee. Engage in conversation to build professional connections concisely.", starters_userAsPrimary: ["Hi, I'm [Your Name]. What brings you to this event?", "That's an interesting point. Could you tell me more?", "It was nice talking to you. Here's my card."], starters_userAsOther: ["Hello! Enjoying the event?", "Hi, I don't think we've met. I'm [Your Name].", "What line of work are you in?"] }
    ]},
    { category: "ì·¨ë¯¸ ë° ê´€ì‹¬ì‚¬ (Hobbies & Interests)", items: [
        { id: "discussing_movie", title: "ì˜í™” ì´ì•¼ê¸°í•˜ê¸° ğŸ¬", description: "ìµœê·¼ì— ë³¸ ì˜í™”ë‚˜ ì¢‹ì•„í•˜ëŠ” ì˜í™”ì— ëŒ€í•´ ì¹œêµ¬ì™€ ì´ì•¼ê¸°í•©ë‹ˆë‹¤.", baseContext: "You are a friend discussing movies with the user. Talk about recent movies, favorite genres, actors, etc. Encourage the user to express their opinions in English. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You are discussing movies with a friend (the user). Share your opinions about movies, genres, actors, etc. concisely.", starters_userAsPrimary: ["Have you seen any good movies lately?", "What's your favorite type of movie?", "I recently watched [Movie Title]..."], starters_userAsOther: ["So, any new movies you'd recommend?", "I'm looking for a good movie to watch, any ideas?", "What did you think of [Movie Title]?"] },
        { id: "talking_about_music", title: "ìŒì•… ì·¨í–¥ ê³µìœ í•˜ê¸° ğŸ¶", description: "ì¢‹ì•„í•˜ëŠ” ìŒì•… ì¥ë¥´, ê°€ìˆ˜, ë…¸ë˜ì— ëŒ€í•´ ì´ì•¼ê¸° ë‚˜ëˆ•ë‹ˆë‹¤.", baseContext: "You are a friend talking about music. Discuss favorite genres, artists, songs, concerts, etc. Help the user share their musical tastes in English. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You are talking about music with a friend (the user). Share your musical tastes, favorite artists, songs, etc. concisely.", starters_userAsPrimary: ["What kind of music do you like?", "Who's your favorite singer?", "Have you heard the new song by [Artist]?"], starters_userAsOther: ["I'm always looking for new music. Any recommendations?", "What have you been listening to lately?", "Do you like [Genre/Artist]?"] },
        { id: "discussing_books", title: "ì±…ì— ëŒ€í•´ ëŒ€í™”í•˜ê¸° ğŸ“š", description: "ì½ì€ ì±…ì´ë‚˜ ì¢‹ì•„í•˜ëŠ” ì‘ê°€, ì¥ë¥´ì— ëŒ€í•´ ì´ì•¼ê¸°í•©ë‹ˆë‹¤.", baseContext: "You are a fellow book lover. The user wants to discuss books they've read, favorite authors, or genres. Share your thoughts and ask them about theirs. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You are discussing books with a fellow book lover (the user). Talk about books you've read, favorite authors, or genres concisely.", starters_userAsPrimary: ["What are you reading currently?", "Do you have a favorite author?", "I just finished a great book called..."], starters_userAsOther: ["Read any good books lately?", "I'm looking for a new book. Any suggestions?", "What kind of books do you usually enjoy?"] },
        { id: "talking_about_sports", title: "ìŠ¤í¬ì¸  ì´ì•¼ê¸°í•˜ê¸° âš½", description: "ì¢‹ì•„í•˜ëŠ” ìŠ¤í¬ì¸ , íŒ€, ì„ ìˆ˜ì— ëŒ€í•´ ì´ì•¼ê¸°í•©ë‹ˆë‹¤.", baseContext: "You are a sports enthusiast. The user wants to talk about sports. Discuss favorite sports, teams, players, recent games, etc. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You are talking about sports with an enthusiast (the user). Discuss your favorite sports, teams, players, or recent games concisely.", starters_userAsPrimary: ["Did you watch the game last night?", "Who's your favorite team?", "I love playing [sport]."], starters_userAsOther: ["That was some game last night, wasn't it?", "Are you a fan of [Sport/Team]?", "What sports do you follow?"] }
    ]},
    { category: "ì‚¬êµ í™œë™ (Socializing)", items: [
        { id: "meeting_new_people", title: "ìƒˆë¡œìš´ ì‚¬ëŒê³¼ ìŠ¤ëª°í†¡ ğŸ‘‹", description: "íŒŒí‹°ë‚˜ ëª¨ì„ì—ì„œ ì²˜ìŒ ë§Œë‚œ ì‚¬ëŒê³¼ ê°€ë²¼ìš´ ëŒ€í™”ë¥¼ ë‚˜ëˆ•ë‹ˆë‹¤.", baseContext: "You are someone the user has just met at a social event. Engage in small talk, ask about their interests, job, etc., to help them practice initiating conversations with new people. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You have just met someone (the user) at a social event. Engage in small talk, share your interests, or ask about theirs concisely.", starters_userAsPrimary: ["Hi, I'm [Your Name]. Nice to meet you.", "So, what do you do for a living?", "Are you enjoying the event?"], starters_userAsOther: ["Hello! I don't think we've met. I'm [Your Name].", "Great event, isn't it?", "Hi there, mind if I join you?"] },
        { id: "inviting_friend", title: "ì¹œêµ¬ ì´ˆëŒ€í•˜ê¸° (ì‹ì‚¬, ì˜í™” ë“±) ğŸ“§", description: "ì¹œêµ¬ì—ê²Œ ì‹ì‚¬ë‚˜ ì˜í™” ê´€ëŒ ë“±ì„ ì œì•ˆí•˜ê³  ì•½ì†ì„ ì¡ìŠµë‹ˆë‹¤.", baseContext: "You are a friend of the user. The user wants to invite you out for a meal, movie, or another activity. Respond to their invitation, discuss plans, and confirm details. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You want to invite your friend (the user). Make an invitation, suggest plans, and confirm details concisely.", starters_userAsPrimary: ["Are you free to grab dinner on Friday?", "I was wondering if you'd like to see a movie with me.", "Let's hang out sometime next week."], starters_userAsOther: ["Hey, what are you up to later?", "I was thinking of [activity], want to join?", "We should get together soon."] },
        { id: "accepting_declining_invitation", title: "ì´ˆëŒ€ ìˆ˜ë½/ê±°ì ˆí•˜ê¸° âœ…âŒ", description: "ì¹œêµ¬ì˜ ì´ˆëŒ€ì— ëŒ€í•´ ìˆ˜ë½í•˜ê±°ë‚˜ ì •ì¤‘íˆ ê±°ì ˆí•˜ëŠ” ë°©ë²•ì„ ì—°ìŠµí•©ë‹ˆë‹¤.", baseContext: "You have invited the user to an event. The user will practice accepting or declining your invitation politely. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You have been invited to an event by the user. Practice accepting or declining the invitation politely and concisely.", starters_userAsPrimary: ["Thanks for inviting me! I'd love to come.", "That sounds great, but I'm afraid I have other plans.", "I appreciate the invitation, but I don't think I can make it."], starters_userAsOther: ["I'm having a get-together on Saturday, would you like to come?", "Want to catch a movie this weekend?", "I'm planning a [event], hope you can make it!"] }
    ]},
    { category: "ë¬¸ì œ í•´ê²° ë° ìš”ì²­ (Problem Solving & Requests)", items: [
        { id: "returning_item", title: "ë¬¼ê±´ í™˜ë¶ˆ/êµí™˜í•˜ê¸° ğŸ›ï¸", description: "ìƒì ì—ì„œ êµ¬ë§¤í•œ ë¬¼ê±´ì„ í™˜ë¶ˆí•˜ê±°ë‚˜ êµí™˜ ìš”ì²­í•˜ëŠ” ìƒí™©ì…ë‹ˆë‹¤.", baseContext: "You are a store clerk. The user wants to return or exchange an item they purchased. Ask for the reason, receipt, and guide them through the store's policy. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You want to return or exchange an item at a store. The user is the store clerk. Explain your reason and follow the process concisely.", starters_userAsPrimary: ["I'd like to return this item, please.", "Can I exchange this for a different size?", "There's a problem with this product I bought."], starters_userAsOther: ["Hi, how can I help you today?", "Do you have your receipt?", "What seems to be the problem with the item?"] },
        { id: "tech_support", title: "ê¸°ìˆ  ì§€ì› ë¬¸ì˜í•˜ê¸° ğŸ’»", description: "ì œí’ˆ ì‚¬ìš© ì¤‘ ë¬¸ì œê°€ ë°œìƒí•˜ì—¬ ê¸°ìˆ  ì§€ì›íŒ€ì— ë¬¸ì˜í•©ë‹ˆë‹¤.", baseContext: "You are a technical support agent. The user is calling about an issue with a product or service. Help them troubleshoot the problem or escalate the issue. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You are calling technical support for an issue with a product or service. The user is the support agent. Describe your problem and seek assistance concisely.", starters_userAsPrimary: ["I'm having trouble with my [product/service].", "My internet isn't working.", "Could you help me fix this error?"], starters_userAsOther: ["Thank you for calling Tech Support, my name is [Your Name]. How can I help you?", "Could you please describe the issue you're experiencing?", "Have you tried restarting your device?"] },
        { id: "making_complaint", title: "ë¶ˆë§Œ ì œê¸°í•˜ê¸° (í˜¸í…”, ì‹ë‹¹ ë“±) ğŸ˜ ", description: "ì„œë¹„ìŠ¤ë‚˜ ì œí’ˆì— ëŒ€í•œ ë¶ˆë§Œì„ ì •ì¤‘í•˜ê²Œ í‘œí˜„í•©ë‹ˆë‹¤.", baseContext: "You are a manager or customer service representative. The user has a complaint about a service or product. Listen to their concerns and try to resolve the issue. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You have a complaint about a service or product. The user is the manager or customer service representative. Express your dissatisfaction politely and concisely.", starters_userAsPrimary: ["I'm afraid I have a complaint about...", "I'm not satisfied with the service I received.", "Could I speak to the manager, please?"], starters_userAsOther: ["I understand you have a concern. Please tell me what happened.", "I'm sorry to hear you're not satisfied. How can I make things right?", "Thank you for bringing this to my attention."] }
    ]},
    { category: "ê±´ê°• ë° ì˜ë£Œ (Health & Medical)", items: [
        { id: "hospital_visit", title: "ë³‘ì› ë°©ë¬¸ (ì¼ë°˜ ì§„ë£Œ) ğŸ¥", description: "ì˜ì‚¬ë‚˜ ê°„í˜¸ì‚¬ì—ê²Œ ì¦ìƒì„ ì„¤ëª…í•˜ê³  ì§„ë£Œ ê´€ë ¨ ëŒ€í™”ë¥¼ ë‚˜ëˆ•ë‹ˆë‹¤. AIëŠ” ì˜ë£Œì§„ ì—­í• ì„ í•©ë‹ˆë‹¤.",
          baseContext: "You are a doctor or nurse at a hospital. The user is a patient explaining their symptoms. Ask clarifying questions ONE AT A TIME. Keep responses concise (1-2 sentences) and professional. Do not ask many questions at once. Do not ask questions you've already received answers for.",
          baseContext_swapped: "You are a patient visiting a doctor/nurse (the user). Describe your symptoms or ask for advice concisely. Respond to one question at a time.",
          starters_userAsPrimary: ["I'd like to see a doctor. I'm not feeling well.", "I have a persistent cough and a sore throat.", "I think I might have sprained my ankle."],
          starters_userAsOther: ["Hello, what seems to be the problem today?", "Good morning. How can I help you?", "Please tell me what's bothering you."] },
        { id: "dentist_visit", title: "ì¹˜ê³¼ ë°©ë¬¸ ğŸ¦·", description: "ì¹˜ê³¼ ì˜ì‚¬ë‚˜ ìœ„ìƒì‚¬ì—ê²Œ ì¹˜ì•„ ë¬¸ì œë¥¼ ì„¤ëª…í•˜ê±°ë‚˜ ì •ê¸° ê²€ì§„ ê´€ë ¨ ëŒ€í™”ë¥¼ í•©ë‹ˆë‹¤. AIëŠ” ì¹˜ê³¼ ì˜ë£Œì§„ ì—­í• ì„ í•©ë‹ˆë‹¤.",
          baseContext: "You are a dentist or dental hygienist. The user is a patient. Ask about their dental issue or needs. Keep questions focused and concise (1-2 sentences per turn). Ask ONE question at a time. Do not ask questions you've already received answers for.",
          baseContext_swapped: "You are a patient at a dental clinic. The user is the dentist/hygienist. Explain your dental concern or reason for visit concisely. Respond to one question at a time.",
          starters_userAsPrimary: ["I have a toothache, and I'd like to make an appointment.", "I'm here for my 6-month check-up and cleaning.", "This tooth has been really sensitive to cold lately."],
          starters_userAsOther: ["Hi, welcome to our dental clinic. How can I help you today?", "What brings you in to see us?", "Are you here for a check-up or a specific issue?"] }
    ]},
    { category: "íŠ¹ë³„í•œ ìƒí™© (Special Occasions)", items: [
        { id: "birthday_party", title: "ìƒì¼ íŒŒí‹° ëŒ€í™” ğŸ‰", description: "ìƒì¼ ì¶•í•˜ ë©”ì‹œì§€ë¥¼ ì „í•˜ê³  íŒŒí‹°ì—ì„œ ëŒ€í™”í•©ë‹ˆë‹¤.", baseContext: "You are a guest at a birthday party. The user is also a guest or the birthday person. Engage in light conversation, offer good wishes. Respond concisely (1-2 sentences) and one question at a time. Do not ask questions you've already received answers for.", baseContext_swapped:"You are at a birthday party. The user is another guest or the birthday person. Engage in conversation and offer good wishes concisely.", starters_userAsPrimary: ["Happy birthday!", "This is a great party!", "How are you enjoying your special day?"], starters_userAsOther: ["Thanks for coming to my party!", "So glad you could make it!", "Are you having a good time?"] },
        { id: "congratulating_someone", title: "ì¶•í•˜ í‘œí˜„í•˜ê¸° ğŸ¥³", description: "ë‹¤ë¥¸ ì‚¬ëŒì˜ ì¢‹ì€ ì¼(ìŠ¹ì§„, ì¡¸ì—… ë“±)ì„ ì¶•í•˜í•©ë‹ˆë‹¤.", baseContext: "You are a friend or colleague of the user. The user wants to congratulate you or someone else on an achievement. Respond appropriately and concisely (1-2 sentences). Do not ask questions you've already received answers for.", baseContext_swapped:"You want to congratulate a friend or colleague (the user) on an achievement. Express your congratulations concisely.", starters_userAsPrimary: ["Congratulations on your promotion!", "That's fantastic news! Well done.", "I'm so happy for you!"], starters_userAsOther: ["Thank you so much!", "I really appreciate that.", "It means a lot to hear that from you."] }
    ]},
    { category: "ì‚¬ìš©ì ì„¤ì •", isCustomCategory: true, items: [
        { id: "custom", title: "ì§ì ‘ ì…ë ¥ âœ¨", description: "ì—°ìŠµí•˜ê³  ì‹¶ì€ ìƒí™©ì´ë‚˜ ëŒ€í™” ì£¼ì œë¥¼ ì•„ë˜ì— ìì„¸íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.", baseContext: "", baseContext_swapped: "", starters_userAsPrimary: ["Let's talk about [your topic].", "I want to practice discussing [your situation].", "Can we simulate a conversation about [your scenario]?"], starters_userAsOther: ["Okay, I'm ready for the custom scenario you described. What's my first line?", "I understand the custom scenario. How should I begin as the other person?", "Let's start the custom role-play. What's my role according to your description?"] }
    ]}
];

const ko_UI_TEXT = {
    appTitle: "SpeakUp AI",
    suggestReplies: "ì‘ë‹µ ì œì•ˆ",
    analyzeSentence: "ë¬¸ì¥ ë¶„ì„",
    roleSwapButtonText: "ì—­í•  ë³€ê²½",
    loading: "ë¡œë”©ì¤‘...",
    aiResponseError: "ì£„ì†¡í•©ë‹ˆë‹¤. AI ì‘ë‹µì„ ìƒì„±í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:",
    errorMessageSuggestions: "ì œì•ˆì„ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",
    errorMessageAnalysis: "ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",
    noUserMessageForAnalysis: "ë¶„ì„í•  ë©”ì‹œì§€ê°€ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ì˜ì–´ë¡œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ì£¼ì„¸ìš”.",
    suggestionsAfterAiResponse: "AI ì‘ë‹µ ì´í›„ì— ì œì•ˆì„ ìš”ì²­í•´ì£¼ì„¸ìš”.",
    scenarioChangeLoadingAlert: "AIê°€ ì‘ë‹µ ì¤‘ì¼ ë•ŒëŠ” ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",
    newConversationLoadingAlert: "AIê°€ ì‘ë‹µ ì¤‘ì¼ ë•ŒëŠ” ìƒˆ ëŒ€í™”ë¥¼ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",
    roleChangeAlert: (role) => `ì—­í• ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤! ì´ì œ ë‹¹ì‹ ì€ ${role}ì…ë‹ˆë‹¤.`,
    newConversationAlert: (scenario) => `"${scenario}" ì‹œë‚˜ë¦¬ì˜¤ë¡œ ìƒˆ ëŒ€í™”ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤!`,
    customScenarioInputRequired: "ì‚¬ìš©ì ì„¤ì • ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì„ íƒí•˜ì…¨ìŠµë‹ˆë‹¤. ì•„ë˜ì— ì—°ìŠµí•˜ê³  ì‹¶ì€ ìƒí™©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.",
    scenarioTitleCustom: (input) => input ? `âœ¨ ì‚¬ìš©ì ì„¤ì •: ${input}` : "âœ¨ ì‚¬ìš©ì ì„¤ì • ì‹œë‚˜ë¦¬ì˜¤",
    customScenarioDescription: "ì…ë ¥í•˜ì‹  ìƒí™©ì— ë§ì¶° AIê°€ ëŒ€í™” ìƒëŒ€ê°€ ë˜ì–´ë“œë¦½ë‹ˆë‹¤.",
    customScenarioPlaceholder: "ì—°ìŠµí•˜ê³  ì‹¶ì€ ìƒí™©ì´ë‚˜ ëŒ€í™” ì£¼ì œë¥¼ ìì„¸íˆ ì…ë ¥í•´ì£¼ì„¸ìš”...",
    starterPhrasePrefix: "ì´ë ‡ê²Œ ì‹œì‘í•´ ë³´ì„¸ìš”:",
    focusTopicPlaceholder: "ì§‘ì¤‘ ì—°ìŠµ ì£¼ì œ (ì„ íƒ ì‚¬í•­)",
    guideModalTitle: "SpeakUp AI ì‚¬ìš© ê°€ì´ë“œ ğŸš€",
    guideModalConfirmButton: "ì•Œê² ìŠµë‹ˆë‹¤!",
    analysisResultTitle: "âœ¨ ë‚´ ë¬¸ì¥ ë¶„ì„ ê²°ê³¼",
    englishFeedbackTitle: "ğŸ“ ì˜ì–´ í”¼ë“œë°±:",
    koreanSummaryTitle: "ğŸ‡°ğŸ‡· í•œêµ­ì–´ ìš”ì•½:",
    analysisConfirmButton: "í™•ì¸í–ˆì–´ìš”!",
    guideP1_html: `<strong>1. ğŸ¤– ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ:</strong><br/> í™”ë©´ ì¢Œì¸¡ ìƒë‹¨ì˜ í˜„ì¬ ì‹œë‚˜ë¦¬ì˜¤ ë²„íŠ¼ (ì˜ˆ: <span class="font-semibold text-sky-600">ì¹´í˜ì—ì„œ</span>)ì„ í´ë¦­í•˜ì„¸ìš”. ë‹¤ì–‘í•œ ì¹´í…Œê³ ë¦¬ë³„ ëŒ€í™” ìƒí™©ì„ ì„ íƒí•˜ê±°ë‚˜, 'âœ¨ ì‚¬ìš©ì ì„¤ì •'ì„ í†µí•´ ì§ì ‘ ì›í•˜ëŠ” ì£¼ì œë¥¼ ì…ë ¥í•˜ì—¬ ì—°ìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`,
    guideP2_html: `<strong>2. ğŸ¯ ì§‘ì¤‘ ì£¼ì œ (ì„ íƒ ì‚¬í•­):</strong><br/> ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª… ì•„ë˜ì— ìˆëŠ” ì…ë ¥ì°½ì— íŠ¹ë³„íˆ ì—°ìŠµí•˜ê³  ì‹¶ì€ ì–´íœ˜ë‚˜ í‘œí˜„ ë“±ì„ ì…ë ¥í•˜ë©´ AIê°€ ëŒ€í™”ì— ë” ì˜ ë°˜ì˜í•´ì¤ë‹ˆë‹¤. (ì‚¬ìš©ì ì„¤ì • ì‹œë‚˜ë¦¬ì˜¤ì—ì„œëŠ” ì´ ì…ë ¥ì°½ì´ ì—†ìŠµë‹ˆë‹¤.)`,
    guideP3_html: `<strong>3. ğŸ—£ï¸ ëŒ€í™” ì‹œì‘í•˜ê¸°:</strong><br/> í™”ë©´ ìƒë‹¨ì— í˜„ì¬ ì‹œë‚˜ë¦¬ì˜¤ì— ë§ëŠ” <span class="text-sky-600 font-medium">"ì´ë ‡ê²Œ ì‹œì‘í•´ ë³´ì„¸ìš”:"</span> ì˜ˆì‹œ ë¬¸ì¥ë“¤ì´ ì œê³µë©ë‹ˆë‹¤. í´ë¦­í•˜ë©´ ë°”ë¡œ ì…ë ¥ì°½ì— ì ìš©ë¼ìš”! ë˜ëŠ” ì§ì ‘ ì˜ì–´ë¡œ ë©”ì‹œì§€ë¥¼ ì‘ì„±í•˜ê³  ì „ì†¡ (ì¢…ì´ë¹„í–‰ê¸° ì•„ì´ì½˜) ë²„íŠ¼ì„ ëˆŒëŸ¬ AI íŠœí„°ì™€ ëŒ€í™”ë¥¼ ì‹œì‘í•˜ì„¸ìš”.`,
    guideP4_header_html: `<strong>4. âœ¨ AI ê¸°ëŠ¥ í™œìš©í•˜ê¸° (ì…ë ¥ì°½ í•˜ë‹¨ ë²„íŠ¼):</strong>`,
    guideP4_item1_html: `<strong class="text-amber-600">ì‘ë‹µ ì œì•ˆ:</strong> ëŒ€í™” ì¤‘ ì–´ë–¤ ë§ì„ í•´ì•¼ í• ì§€ ë§‰ë§‰í•  ë•Œ ëˆ„ë¥´ë©´, AIê°€ 3ê°€ì§€ ì‘ë‹µ ì˜ˆì‹œë¥¼ ì¶”ì²œí•´ì¤ë‹ˆë‹¤.`,
    guideP4_item2_html: `<strong class="text-teal-600">ë¬¸ì¥ ë¶„ì„:</strong> ë°©ê¸ˆ ë‚´ê°€ ë³´ë‚¸ ì˜ì–´ ë¬¸ì¥ì— ëŒ€í•´ AIê°€ ë¬¸ë²•, ì–´íœ˜, ìì—°ìŠ¤ëŸ¬ì›€ ë“±ì„ ë¶„ì„í•˜ê³ , <span class="text-sky-600">í•œêµ­ì–´ ìš”ì•½</span>ë„ í•¨ê»˜ ì œê³µí•©ë‹ˆë‹¤.`,
    guideP4_item3_html: `<strong class="text-indigo-600">ì—­í•  ë³€ê²½:</strong> í˜„ì¬ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ì‚¬ìš©ìì™€ AIì˜ ì—­í• ì„ ì„œë¡œ ë°”ê¿‰ë‹ˆë‹¤. (ì˜ˆ: ì†ë‹˜ â†” ì ì›) ì—­í• ì´ ë°”ë€Œë©´ ìƒˆë¡œìš´ ì‹œì‘ í‘œí˜„ë„ ì œê³µë©ë‹ˆë‹¤.`,
    guideP5_html: `<strong>5. ğŸ”„ ìƒˆ ëŒ€í™” ì‹œì‘:</strong><br/> í™”ë©´ ìš°ì¸¡ ìƒë‹¨ì˜ ìƒˆë¡œê³ ì¹¨ ì•„ì´ì½˜ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´, í˜„ì¬ ì„ íƒëœ ì‹œë‚˜ë¦¬ì˜¤ (ë˜ëŠ” ì‚¬ìš©ì ì„¤ì • ì£¼ì œ) ë° ì—­í• ë¡œ ëŒ€í™” ë‚´ìš©ì„ ì´ˆê¸°í™”í•˜ê³  ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì—°ìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`
};

// ì¼ë³¸ì–´ ì–¸ì–´ ë°ì´í„°
const ja_SCENARIO_DATA = [
    { category: "æ—¥å¸¸ç”Ÿæ´»", items: [
        { id: "cafe", title: "ã‚«ãƒ•ã‚§ã§æ³¨æ–‡ â˜•", description: "ãƒãƒªã‚¹ã‚¿ã«ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’æ³¨æ–‡ã—ã€ç°¡å˜ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚AIã¯è¦ªåˆ‡ãªãƒãƒªã‚¹ã‚¿ã®å½¹å‰²ã‚’æ¼”ã˜ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯è¦ªåˆ‡ãªãƒãƒªã‚¹ã‚¿ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’æ³¨æ–‡ã—ã¦ã„ã¾ã™ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€å¿…è¦ã«å¿œã˜ã¦ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ã€æ³¨æ–‡ã‚’æ‰‹ä¼ã£ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’æ³¨æ–‡ã™ã‚‹å®¢ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒãƒªã‚¹ã‚¿ã§ã™ã€‚æ³¨æ–‡ã‚’ã—ã¦ã€è³ªå•ãŒã‚ã‚Œã°èã„ã¦ãã ã•ã„ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ç°¡æ½”ã«ã—ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["ã“ã‚“ã«ã¡ã¯ã€ãƒ©ãƒ†ã‚’ãŠé¡˜ã„ã—ã¾ã™", "ä½•ã‹ãŠã™ã™ã‚ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’æ³¨æ–‡ã—ãŸã„ã®ã§ã™ãŒ"],
          starters_userAsOther: ["ã„ã‚‰ã£ã—ã‚ƒã„ã¾ã›ï¼ä»Šæ—¥ã¯ä½•ã‚’ãŠä½œã‚Šã—ã¾ã—ã‚‡ã†ã‹ï¼Ÿ", "ã‚ˆã†ã“ãï¼ã”æ³¨æ–‡ã¯ãŠæ±ºã¾ã‚Šã§ã™ã‹ï¼Ÿ", "ã“ã‚“ã«ã¡ã¯ï¼ä½•ã‹ãŠæ‰‹ä¼ã„ã§ãã¾ã™ã‹ï¼Ÿ"] },
        { id: "grocery_shopping", title: "ã‚¹ãƒ¼ãƒ‘ãƒ¼ã§è²·ã„ç‰© ğŸ›’", description: "åº—å“¡ã«å•†å“ã®å ´æ‰€ã‚’å°‹ã­ãŸã‚Šã€ãƒ¬ã‚¸ã§ã®ä¼šè©±ã‚’ç·´ç¿’ã—ã¾ã™ã€‚AIã¯è¦ªåˆ‡ãªåº—å“¡ã®å½¹å‰²ã‚’æ¼”ã˜ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯è¦ªåˆ‡ãªã‚¹ãƒ¼ãƒ‘ãƒ¼ã®åº—å“¡ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è²·ã„ç‰©ã‚’ã—ã¦ã„ã¾ã™ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€å•†å“ã‚’è¦‹ã¤ã‘ãŸã‚Šãƒ¬ã‚¸ã‚’æ‰‹ä¼ã£ãŸã‚Šã—ã¦ãã ã•ã„ã€‚å¿…è¦ã«å¿œã˜ã¦ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯ã‚¹ãƒ¼ãƒ‘ãƒ¼ã®å®¢ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯åº—å“¡ã§ã™ã€‚åŠ©ã‘ã‚’æ±‚ã‚ãŸã‚Šã€ãƒ¬ã‚¸ã«é€²ã‚“ã ã‚Šã—ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ã€‚",
          starters_userAsPrimary: ["ã™ã¿ã¾ã›ã‚“ã€ç‰›ä¹³ã¯ã©ã“ã«ã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "ã“ã‚Œã¯ã„ãã‚‰ã§ã™ã‹ï¼Ÿ", "ã“ã‚Œã‚‰ã®å•†å“ã‚’è²·ã„ãŸã„ã®ã§ã™ãŒ"],
          starters_userAsOther: ["ã„ã‚‰ã£ã—ã‚ƒã„ã¾ã›ï¼ä½•ã‹ãŠæ¢ã—ã§ã™ã‹ï¼Ÿ", "ãƒ¬ã‚¸ã«ãŠé€²ã¿ã§ã™ã‹ï¼Ÿ", "ãŠæ¢ã—ã®ã‚‚ã®ã¯è¦‹ã¤ã‹ã‚Šã¾ã—ãŸã‹ï¼Ÿ"] },
        { id: "making_appointments", title: "äºˆç´„ã™ã‚‹ï¼ˆç¾å®¹é™¢ã€ç—…é™¢ãªã©ï¼‰ğŸ—“ï¸", description: "é›»è©±ã‚„è¨ªå•ã§äºˆç´„ã‚’ã™ã‚‹çŠ¶æ³ã‚’ç·´ç¿’ã—ã¾ã™ã€‚AIã¯å—ä»˜ä¿‚ã®å½¹å‰²ã‚’æ¼”ã˜ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯ç¾å®¹é™¢/ã‚¯ãƒªãƒ‹ãƒƒã‚¯ã®å—ä»˜ä¿‚ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯äºˆç´„ã‚’ã—ãŸãŒã£ã¦ã„ã¾ã™ã€‚ç°¡æ½”ã«ï¼ˆ1ã‚¿ãƒ¼ãƒ³ã«1ï½2æ–‡ï¼‰æ¡ˆå†…ã—ã€å¥½ã¿ã‚’å°‹ã­ã¦è©³ç´°ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯äºˆç´„ã‚’ã—ãŸã„äººã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å—ä»˜ä¿‚ã§ã™ã€‚ãƒ‹ãƒ¼ã‚ºã‚’ç°¡æ½”ã«è¿°ã¹ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["ãƒ˜ã‚¢ã‚«ãƒƒãƒˆã®äºˆç´„ã‚’ã—ãŸã„ã®ã§ã™ãŒ", "æ¥é€±ã®ç«æ›œæ—¥ã«ç©ºãã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "ä»Šé€±ã®æ¤œè¨ºã‚’äºˆç´„ã§ãã¾ã™ã‹ï¼Ÿ"],
          starters_userAsOther: ["ãŠé›»è©±ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚[ã‚µãƒ­ãƒ³/ã‚¯ãƒªãƒ‹ãƒƒã‚¯å]ã§ã™ã€‚ã©ã®ã‚ˆã†ãªã”ç”¨ä»¶ã§ã—ã‚‡ã†ã‹ï¼Ÿ", "ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ï¼äºˆç´„ã®ãŠæ‰‹ä¼ã„ã‚’ã•ã›ã¦ã„ãŸã ãã¾ã™", "äºˆç´„ã‚’ã”å¸Œæœ›ã§ã™ã‹ï¼Ÿ"] },
        { id: "daily_routine_talk", title: "æ—¥å¸¸ã®è©±ã‚’ã™ã‚‹ â˜€ï¸", description: "ä¸€æ—¥ã®å‡ºæ¥äº‹ã‚„é€±æœ«ã®è¨ˆç”»ãªã©ã€æ—¥å¸¸çš„ãªè©±é¡Œã§ä¼šè©±ã—ã¾ã™ã€‚AIã¯å‹é”ã®å½¹å‰²ã‚’æ¼”ã˜ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯å‹é”ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯æ—¥å¸¸ç”Ÿæ´»ã«ã¤ã„ã¦è©±ã—ãŸãŒã£ã¦ã„ã¾ã™ã€‚ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ã§ç°¡æ½”ãªï¼ˆ1ã‚¿ãƒ¼ãƒ³ã«1ï½2æ–‡ï¼‰ä¼šè©±ã‚’ã—ã¦ãã ã•ã„ã€‚å¿…è¦ã«å¿œã˜ã¦ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯å‹é”ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ã¨è©±ã—ã¦ã„ã¾ã™ã€‚ã‚ãªãŸã®ä¸€æ—¥ã«ã¤ã„ã¦ä½•ã‹å…±æœ‰ã—ãŸã‚Šã€ç›¸æ‰‹ã®ã“ã¨ã‚’èã„ãŸã‚Šã—ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ã€‚",
          starters_userAsPrimary: ["ä»Šæ—¥ã¯ã©ã†ã ã£ãŸï¼Ÿ", "é€±æœ«ã¯ä½•ã‹äºˆå®šã‚ã‚‹ï¼Ÿ", "ç§ã¯æœã«[æ´»å‹•]ã‚’ã™ã‚‹ã‚ˆ"],
          starters_userAsOther: ["ã‚„ã‚ï¼æœ€è¿‘ã©ã†ï¼Ÿ", "å…ƒæ°—ï¼Ÿ", "ä»Šæ—¥ä½•ã‹é¢ç™½ã„ã“ã¨ã‚ã£ãŸï¼Ÿ"] },
        { id: "public_transportation", title: "å…¬å…±äº¤é€šæ©Ÿé–¢ã‚’ä½¿ã† ğŸšŒ", description: "ãƒã‚¹ã‚„åœ°ä¸‹é‰„ã®åˆ‡ç¬¦ã‚’è²·ã£ãŸã‚Šã€é“ã‚’å°‹ã­ã‚‹çŠ¶æ³ã§ã™ã€‚AIã¯é§…å“¡ã¾ãŸã¯ä»–ã®ä¹—å®¢ã®å½¹å‰²ã‚’æ¼”ã˜ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯å…¬å…±äº¤é€šæ©Ÿé–¢ã®ã‚¹ã‚¿ãƒƒãƒ•ã¾ãŸã¯è¦ªåˆ‡ãªä¹—å®¢ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯åŠ©ã‘ãŒå¿…è¦ã§ã™ã€‚æ˜ç¢ºã§ç°¡æ½”ãªï¼ˆ1ã‚¿ãƒ¼ãƒ³ã«1ï½2æ–‡ï¼‰ã‚µãƒãƒ¼ãƒˆã‚’æä¾›ã—ã¦ãã ã•ã„ã€‚å¿…è¦ã«å¿œã˜ã¦ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯å…¬å…±äº¤é€šæ©Ÿé–¢ã®åŠ©ã‘ãŒå¿…è¦ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã‚¹ã‚¿ãƒƒãƒ•/ä¹—å®¢ã§ã™ã€‚ç°¡æ½”ã«è³ªå•ã—ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["ãƒ€ã‚¦ãƒ³ã‚¿ã‚¦ãƒ³ã¸è¡Œããƒã‚¹ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ", "ç‰‡é“åˆ‡ç¬¦ã¯ã„ãã‚‰ã§ã™ã‹ï¼Ÿ", "ã“ã“ã¯æ€¥è¡Œé›»è»Šã®ãƒ›ãƒ¼ãƒ ã§ã™ã‹ï¼Ÿ"],
          starters_userAsOther: ["ä½•ã‹ãŠæ‰‹ä¼ã„ã—ã¾ã—ã‚‡ã†ã‹ï¼Ÿ", "ç‰¹å®šã®è·¯ç·šã‚’ãŠæ¢ã—ã§ã™ã‹ï¼Ÿ", "åˆ‡ç¬¦ã¯ã‚ã¡ã‚‰ã§è³¼å…¥ã§ãã¾ã™"] }
    ]},
    { category: "æ—…è¡Œ", items: [
        { id: "airport_checkin", title: "ç©ºæ¸¯ã§ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ âœˆï¸", description: "ç©ºæ¸¯ã®ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã§æ­ä¹—æ‰‹ç¶šãã‚’ã—ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯èˆªç©ºä¼šç¤¾ã®ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ä¿‚ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒ•ãƒ©ã‚¤ãƒˆã®ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ã‚’ã—ã¦ã„ã¾ã™ã€‚ãƒ‘ã‚¹ãƒãƒ¼ãƒˆ/ãƒã‚±ãƒƒãƒˆã‚’æ±‚ã‚ã€è·ç‰©ã€åº§å¸­ã®å¥½ã¿ã«ã¤ã„ã¦è©±ã—åˆã£ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯ç©ºæ¸¯ã§ãƒ•ãƒ©ã‚¤ãƒˆã®ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ã‚’ã—ã¦ã„ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ä¿‚ã§ã™ã€‚æ›¸é¡ã‚’æä¾›ã—ã€ãƒ•ãƒ©ã‚¤ãƒˆã®è©³ç´°ã«ã¤ã„ã¦ç°¡æ½”ã«è©±ã—åˆã£ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["ãƒ­ãƒ³ãƒ‰ãƒ³è¡Œãã®ãƒ•ãƒ©ã‚¤ãƒˆã«ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ã—ãŸã„ã®ã§ã™ãŒ", "ãƒ‘ã‚¹ãƒãƒ¼ãƒˆã¨ãƒã‚±ãƒƒãƒˆã§ã™", "çª“å´ã®å¸­ã‚’ãŠé¡˜ã„ã§ãã¾ã™ã‹ï¼Ÿ"],
          starters_userAsOther: ["ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ï¼ãƒ‘ã‚¹ãƒãƒ¼ãƒˆã¨ãƒã‚±ãƒƒãƒˆã‚’æ‹è¦‹ã§ãã¾ã™ã‹ï¼Ÿ", "ä»Šæ—¥ã¯ã©ã¡ã‚‰ã¸é£›ã°ã‚Œã¾ã™ã‹ï¼Ÿ", "é ã‘ã‚‹è·ç‰©ã¯ã”ã–ã„ã¾ã™ã‹ï¼Ÿ"] },
        { id: "hotel_checkin", title: "ãƒ›ãƒ†ãƒ«ã§ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ ğŸ¨", description: "ãƒ›ãƒ†ãƒ«ã®ãƒ•ãƒ­ãƒ³ãƒˆã§äºˆç´„ç¢ºèªã¨ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ã‚’ã—ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯ãƒ›ãƒ†ãƒ«ã®å—ä»˜ä¿‚ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ã—ã¦ã„ã¾ã™ã€‚äºˆç´„ã‚’ç¢ºèªã—ã€è¨­å‚™ã‚’èª¬æ˜ã—ã€è³ªå•ã«ç­”ãˆã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯ãƒ›ãƒ†ãƒ«ã«ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ã—ã¦ã„ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å—ä»˜ä¿‚ã§ã™ã€‚äºˆç´„ã®è©³ç´°ã‚’æä¾›ã—ã€å¿…è¦ãªè³ªå•ã‚’ç°¡æ½”ã«ã—ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["[åå‰]ã§äºˆç´„ã—ã¦ã„ã¾ã™", "æœé£Ÿã¯ä½•æ™‚ã‹ã‚‰ã§ã™ã‹ï¼Ÿ", "éƒ¨å±‹ã«Wi-Fiã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ"],
          starters_userAsOther: ["ã‚ˆã†ã“ãï¼ã©ã®ã‚ˆã†ãªã”ç”¨ä»¶ã§ã—ã‚‡ã†ã‹ï¼Ÿ", "å½“ãƒ›ãƒ†ãƒ«ã«ã”äºˆç´„ã¯ã”ã–ã„ã¾ã™ã‹ï¼Ÿ", "ãŠåå‰ã‚’ãŠèã‹ã›ãã ã•ã„"] },
        { id: "asking_directions", title: "é“ã‚’å°‹ã­ã‚‹ ğŸ—ºï¸", description: "æ—…è¡Œä¸­ã«çŸ¥ã‚‰ãªã„å ´æ‰€ã§é“ã‚’å°‹ã­ã‚‹çŠ¶æ³ã§ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯åœ°å…ƒã®ä½æ°‘ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯é“ã‚’å°‹ã­ã‚‹è¦³å…‰å®¢ã§ã™ã€‚æ˜ç¢ºã§ç°¡æ½”ãªï¼ˆ1ï½2æ–‡ï¼‰æŒ‡ç¤ºã‚’æä¾›ã—ã€è¦ªåˆ‡ã«ã—ã¦ãã ã•ã„ã€‚å¿…è¦ã«å¿œã˜ã¦ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯é“ã‚’å°‹ã­ã‚‹è¦³å…‰å®¢ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯åœ°å…ƒã®ä½æ°‘ã§ã™ã€‚é“ã‚’è¦‹ã¤ã‘ã‚‹ã®ã‚’æ‰‹ä¼ã£ã¦ã‚‚ã‚‰ã†ã‚ˆã†ç°¡æ½”ã«é ¼ã‚“ã§ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["ã™ã¿ã¾ã›ã‚“ã€åšç‰©é¤¨ã¸ã®è¡Œãæ–¹ã‚’æ•™ãˆã¦ãã ã•ã„", "åœ°å›³ã§ç¤ºã—ã¦ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ", "é§…ã¸ã¯ã“ã®é“ã§åˆã£ã¦ã„ã¾ã™ã‹ï¼Ÿ"],
          starters_userAsOther: ["ã¯ã„ã€ã©ã†ã•ã‚Œã¾ã—ãŸã‹ï¼Ÿ", "ã©ã¡ã‚‰ã¸è¡Œã‹ã‚ŒãŸã„ã§ã™ã‹ï¼Ÿ", "ã‚‚ã¡ã‚ã‚“ã€ãŠæ‰‹ä¼ã„ã—ã¾ã™"] },
        { id: "ordering_at_restaurant_travel", title: "æ—…è¡Œä¸­ã«ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã§æ³¨æ–‡ ğŸ½ï¸", description: "æ—…è¡Œå…ˆã®ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã§é£Ÿäº‹ã‚’æ³¨æ–‡ã—ã€ç¾åœ°ã®æ–™ç†ã«ã¤ã„ã¦è³ªå•ã—ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯è¦³å…‰å®¢å‘ã‘ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã®ã‚¦ã‚§ã‚¤ã‚¿ãƒ¼/ã‚¦ã‚§ã‚¤ãƒˆãƒ¬ã‚¹ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯é£Ÿäº‹ã‚’æ³¨æ–‡ã—ã€åœ°å…ƒã®ç‰¹ç”£å“ã«ã¤ã„ã¦å°‹ã­ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚å¿è€å¼·ãè¦ªåˆ‡ã«ã—ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯è¦³å…‰åœ°ã®ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã®å®¢ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã‚¦ã‚§ã‚¤ã‚¿ãƒ¼/ã‚¦ã‚§ã‚¤ãƒˆãƒ¬ã‚¹ã§ã™ã€‚é£Ÿäº‹ã‚’æ³¨æ–‡ã—ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«ã¤ã„ã¦ç°¡æ½”ã«å°‹ã­ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["ã“ã“ã®åç‰©æ–™ç†ã¯ä½•ã§ã™ã‹ï¼Ÿ", "ä½•ã‹ä¼çµ±çš„ãªã‚‚ã®ã‚’è©¦ã—ã¦ã¿ãŸã„ã§ã™", "ãŠã™ã™ã‚ã®æ–™ç†ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ"],
          starters_userAsOther: ["ã„ã‚‰ã£ã—ã‚ƒã„ã¾ã›ï¼ã”æ³¨æ–‡ã¯ãŠæ±ºã¾ã‚Šã§ã™ã‹ã€ãã‚Œã¨ã‚‚ã‚‚ã†å°‘ã—ãŠæ™‚é–“ãŒå¿…è¦ã§ã™ã‹ï¼Ÿ", "ã¾ãšãŠé£²ã¿ç‰©ã¯ã„ã‹ãŒã§ã™ã‹ï¼Ÿ", "ä½•ã‚’ãŠæŒã¡ã—ã¾ã—ã‚‡ã†ã‹ï¼Ÿ"] },
        { id: "booking_tour", title: "æ—…è¡Œãƒ„ã‚¢ãƒ¼ã‚’äºˆç´„ã™ã‚‹ ğŸï¸", description: "ç¾åœ°ã®ãƒ„ã‚¢ãƒ¼ã‚„ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’äºˆç´„ã™ã‚‹çŠ¶æ³ã§ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯æ—…è¡Œä»£ç†åº—ã¾ãŸã¯ãƒ„ã‚¢ãƒ¼ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒ„ã‚¢ãƒ¼ã‚„ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’äºˆç´„ã—ãŸãŒã£ã¦ã„ã¾ã™ã€‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€ä¾¡æ ¼ã«ã¤ã„ã¦æƒ…å ±ã‚’æä¾›ã—ã€äºˆç´„ã—ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯åœ°å…ƒã®ãƒ„ã‚¢ãƒ¼ã‚„ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’äºˆç´„ã—ãŸãŒã£ã¦ã„ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯æ—…è¡Œä»£ç†åº—ã§ã™ã€‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦å°‹ã­ã€ç°¡æ½”ã«äºˆç´„ã—ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["å¸‚å†…è¦³å…‰ãƒ„ã‚¢ãƒ¼ã‚’äºˆç´„ã—ãŸã„ã®ã§ã™ãŒ", "ã©ã‚“ãªãƒ„ã‚¢ãƒ¼ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "[ãƒ„ã‚¢ãƒ¼å]ã®æ–™é‡‘ã¯ã„ãã‚‰ã§ã™ã‹ï¼Ÿ"],
          starters_userAsOther: ["ã“ã‚“ã«ã¡ã¯ï¼ä»Šæ—¥ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£è¨ˆç”»ã‚’ãŠæ‰‹ä¼ã„ã—ã¾ã—ã‚‡ã†ã‹ï¼Ÿ", "ã„ãã¤ã‹ãƒ„ã‚¢ãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚ä½•ã«èˆˆå‘³ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "ç¢ºã‹ã«ã€ç©ºãçŠ¶æ³ã‚’ç¢ºèªã•ã›ã¦ãã ã•ã„"] },
        { id: "at_immigration", title: "å…¥å›½å¯©æŸ»ã§ ğŸ›‚", description: "ç©ºæ¸¯ã®å…¥å›½å¯©æŸ»ã§å¯©æŸ»å®˜ã®è³ªå•ã«ç­”ãˆã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯å…¥å›½å¯©æŸ»å®˜ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å…¥å›½ã—ã¦ã„ã¾ã™ã€‚è¨ªå•ã®ç›®çš„ã€æ»åœ¨æœŸé–“ã«ã¤ã„ã¦å°‹ã­ã€æ›¸é¡ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯æ–°ã—ã„å›½ã«åˆ°ç€ã—ãŸå…¥å›½å¯©æŸ»ã‚’å—ã‘ã¦ã„ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å…¥å›½å¯©æŸ»å®˜ã§ã™ã€‚è¨ªå•ã«ã¤ã„ã¦ç°¡æ½”ã«è³ªå•ã«ç­”ãˆã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ã€‚ãƒ‘ã‚¹ãƒãƒ¼ãƒˆã‚’æ‹è¦‹ã§ãã¾ã™ã‹ï¼Ÿ", "è¨ªå•ã®ç›®çš„ã¯ä½•ã§ã™ã‹ï¼Ÿ", "ã©ã®ãã‚‰ã„æ»åœ¨äºˆå®šã§ã™ã‹ï¼Ÿ"],
          starters_userAsOther: ["æ¬¡ã®æ–¹ã€ã©ã†ãã€‚ãƒ‘ã‚¹ãƒãƒ¼ãƒˆã¨å…¥å›½ã‚«ãƒ¼ãƒ‰", "ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ã€‚[å›½]ã¸ã‚ˆã†ã“ã", "[å›½]ã¸ã®è¨ªå•ã®ç›®çš„ã¯ä½•ã§ã™ã‹ï¼Ÿ"] }
    ]},
    { category: "ä»•äº‹ãƒ»ãƒ“ã‚¸ãƒã‚¹", items: [
        { id: "job_interview", title: "é¢æ¥ã‚’å—ã‘ã‚‹ ğŸ’¼", description: "å°±è·é¢æ¥ã®çŠ¶æ³ã‚’ç·´ç¿’ã—ã¾ã™ã€‚è‡ªå·±ç´¹ä»‹ã€è³ªå•ã¸ã®å›ç­”ãªã©ã€‚",
          baseContext: "ã‚ãªãŸã¯è·ä½ã®é¢æ¥å®˜ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å€™è£œè€…ã§ã™ã€‚ä¸€èˆ¬çš„ãªé¢æ¥ã®è³ªå•ã‚’ã—ã€è‹±èªã§ã®å›ç­”ã‚’è©•ä¾¡ã—ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯å°±è·é¢æ¥ã®å€™è£œè€…ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯é¢æ¥å®˜ã§ã™ã€‚è³‡æ ¼ã‚„çµŒé¨“ã«ã¤ã„ã¦è³ªå•ã«ç°¡æ½”ã«ç­”ãˆã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["è‡ªå·±ç´¹ä»‹ã‚’ãŠé¡˜ã„ã—ã¾ã™", "ãªãœã“ã®ãƒã‚¸ã‚·ãƒ§ãƒ³ã«èˆˆå‘³ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "ã‚ãªãŸã®å¼·ã¿ã¯ä½•ã§ã™ã‹ï¼Ÿ"],
          starters_userAsOther: ["æœ¬æ—¥ã¯ãŠè¶Šã—ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ã©ã†ããŠåº§ã‚Šãã ã•ã„", "ãã‚Œã§ã¯ã€å°‘ã—è‡ªå·±ç´¹ä»‹ã‚’ã—ã¦ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ", "ãªãœå¼Šç¤¾ã®ã“ã®å½¹è·ã«èˆˆå‘³ã‚’æŒãŸã‚ŒãŸã®ã§ã™ã‹ï¼Ÿ"] },
        { id: "meeting_colleagues", title: "åŒåƒšã¨ä¼šè­°ã‚’ã™ã‚‹ ğŸ‘¥", description: "ä»•äº‹é–¢é€£ã®ä¼šè­°ã§æ„è¦‹ã‚’è¿°ã¹ãŸã‚Šã€è­°è«–ã—ãŸã‚Šã—ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯ãƒ“ã‚¸ãƒã‚¹ä¼šè­°ã®åŒåƒšã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ä¼šè­°ã«å‚åŠ ã—ã¦ã„ã¾ã™ã€‚è­°é¡Œã«ã¤ã„ã¦è©±ã—åˆã„ã€æ„è¦‹ã‚’å…±æœ‰ã—ã€å”åŠ›ã—ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯åŒåƒšã¨ã®ãƒ“ã‚¸ãƒã‚¹ä¼šè­°ã«å‚åŠ ã—ã¦ã„ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã‚ãªãŸã®åŒåƒšã®ä¸€äººã§ã™ã€‚æ„è¦‹ã‚’å…±æœ‰ã—ã€è­°é¡Œã«ã¤ã„ã¦ç°¡æ½”ã«è©±ã—åˆã£ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ææ¡ˆã—ãŸã„ã¨æ€ã„ã¾ã™", "ã“ã®ææ¡ˆã«ã¤ã„ã¦ã©ã†æ€ã„ã¾ã™ã‹ï¼Ÿ", "æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã«ã¤ã„ã¦è©±ã—åˆã„ã¾ã—ã‚‡ã†"],
          starters_userAsOther: ["ã§ã¯çš†ã•ã‚“ã€å§‹ã‚ã¾ã—ã‚‡ã†ã€‚è­°é¡Œã®æœ€åˆã®é …ç›®ã¯...", "ã“ã‚Œã«ã¤ã„ã¦æœ€åˆã®æ„è¦‹ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "[ãƒ¦ãƒ¼ã‚¶ãƒ¼å]ã•ã‚“ã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ä»–ã®çš†ã•ã‚“ã¯ã©ã†æ€ã„ã¾ã™ã‹ï¼Ÿ"] },
        { id: "phone_call_business", title: "ãƒ“ã‚¸ãƒã‚¹é›»è©±ã‚’ã‹ã‘ã‚‹ ğŸ“", description: "ãƒ“ã‚¸ãƒã‚¹ç›®çš„ã§é›»è©±ã‚’ã‹ã‘ãŸã‚Šå—ã‘ãŸã‚Šã™ã‚‹çŠ¶æ³ã§ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯é›»è©±ã§ã®ãƒ“ã‚¸ãƒã‚¹ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒ“ã‚¸ãƒã‚¹é›»è©±ã‚’é–‹å§‹ã¾ãŸã¯å—ä¿¡ã—ã¦ã„ã¾ã™ã€‚å•ã„åˆã‚ã›ã«å¯¾å¿œã—ã€ä¼šè­°ã‚’ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã—ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¤ã„ã¦å°‚é–€çš„ã«è©±ã—åˆã£ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯ãƒ“ã‚¸ãƒã‚¹é›»è©±ã‚’ã‹ã‘ãŸã‚Šå—ã‘ãŸã‚Šã—ã¦ã„ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ç›¸æ‰‹ã§ã™ã€‚å°‚é–€çš„ãªäº‹é …ã«ã¤ã„ã¦è©±ã—åˆã„ã€ã‚¢ãƒã‚¤ãƒ³ãƒˆãƒ¡ãƒ³ãƒˆã‚’ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã—ã€ç°¡æ½”ã«å•ã„åˆã‚ã›ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["ã“ã‚“ã«ã¡ã¯ã€[ä¼šç¤¾å]ã®[ã‚ãªãŸã®åå‰]ã§ã™", "[åå‰]ã•ã‚“ã¨ãŠè©±ã—ã§ãã¾ã™ã‹ï¼Ÿ", "ï½ã«ã¤ã„ã¦å•ã„åˆã‚ã›ãŸãã¦ãŠé›»è©±ã—ã¾ã—ãŸ"],
          starters_userAsOther: ["ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ã€[ä¼šç¤¾å]ã€[ã‚ãªãŸã®åå‰]ã§ã™ã€‚ã©ã®ã‚ˆã†ãªã”ç”¨ä»¶ã§ã—ã‚‡ã†ã‹ï¼Ÿ", "ãŠé›»è©±ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚[ã‚ãªãŸã®åå‰]ã§ã™", "[ãƒ¦ãƒ¼ã‚¶ãƒ¼å]ã§ã™"] },
        { id: "presentation_qna", title: "ãƒ—ãƒ¬ã‚¼ãƒ³å¾Œã®è³ªç–‘å¿œç­” ğŸ¤", description: "ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’çµ‚ãˆãŸå¾Œã€è´è¡†ã®è³ªå•ã«ç­”ãˆã‚‹çŠ¶æ³ã§ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å¾Œã®è´è¡†ãƒ¡ãƒ³ãƒãƒ¼ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ã§ã™ã€‚ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦é–¢é€£ã™ã‚‹è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’çµ‚ãˆãŸã°ã‹ã‚Šã®ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¿ãƒ¼ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è³ªå•ã‚’ã™ã‚‹è´è¡†ãƒ¡ãƒ³ãƒãƒ¼ã§ã™ã€‚è³ªå•ã«æ˜ç¢ºã‹ã¤ç°¡æ½”ã«ç­”ãˆã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚ï½ã«ã¤ã„ã¦è³ªå•ãŒã‚ã‚Šã¾ã™", "[ç‰¹å®šã®ãƒã‚¤ãƒ³ãƒˆ]ã«ã¤ã„ã¦è©³ã—ãèª¬æ˜ã—ã¦ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ", "ã‚ãªãŸã®ç™ºè¦‹ã®æ„å‘³ã¯ä½•ã§ã™ã‹ï¼Ÿ"],
          starters_userAsOther: ["ç´ æ™´ã‚‰ã—ã„ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚è³ªå•ã®æ™‚é–“ãŒã‚ã‚Šã¾ã™", "ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ã¸ã®è³ªå•ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "ã¯ã„ã€å¾Œã‚ã®æ–¹ï¼Ÿ"] },
        { id: "networking_event", title: "ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ã‚¤ãƒ™ãƒ³ãƒˆ ğŸ¤", description: "æ¥­ç•Œã®ã‚¤ãƒ™ãƒ³ãƒˆã§æ–°ã—ã„äººã€…ã¨äº¤æµã—ã€ä¼šè©±ã—ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ã‚¤ãƒ™ãƒ³ãƒˆã«å‚åŠ ã—ã¦ã„ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚‚å‚åŠ è€…ã§ã™ã€‚ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªã¤ãªãŒã‚Šã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã«ä¼šè©±ã‚’å§‹ã‚ãŸã‚Šå¿œç­”ã—ãŸã‚Šã—ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ã‚¤ãƒ™ãƒ³ãƒˆã«å‚åŠ ã—ã¦ã„ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯åˆ¥ã®å‚åŠ è€…ã§ã™ã€‚ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªã¤ãªãŒã‚Šã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã«ç°¡æ½”ã«ä¼šè©±ã—ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["ã“ã‚“ã«ã¡ã¯ã€[ã‚ãªãŸã®åå‰]ã§ã™ã€‚ã“ã®ã‚¤ãƒ™ãƒ³ãƒˆã«ä½•ã‚’ã‚‚ãŸã‚‰ã—ã¾ã—ãŸã‹ï¼Ÿ", "ãã‚Œã¯èˆˆå‘³æ·±ã„ç‚¹ã§ã™ã­ã€‚ã‚‚ã£ã¨æ•™ãˆã¦ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ", "ãŠè©±ã—ã§ãã¦è‰¯ã‹ã£ãŸã§ã™ã€‚ã“ã‚ŒãŒç§ã®ååˆºã§ã™"],
          starters_userAsOther: ["ã“ã‚“ã«ã¡ã¯ï¼ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ¥½ã—ã‚“ã§ã„ã¾ã™ã‹ï¼Ÿ", "ã“ã‚“ã«ã¡ã¯ã€ã¾ã ãŠä¼šã„ã—ã¦ã„ãªã„ã¨æ€ã„ã¾ã™ã€‚[ã‚ãªãŸã®åå‰]ã§ã™", "ã©ã®ã‚ˆã†ãªä»•äº‹ã‚’ã•ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ"] }
    ]},
    { category: "è¶£å‘³ãƒ»é–¢å¿ƒäº‹", items: [
        { id: "discussing_movie", title: "æ˜ ç”»ã«ã¤ã„ã¦è©±ã™ ğŸ¬", description: "æœ€è¿‘è¦‹ãŸæ˜ ç”»ã‚„å¥½ããªæ˜ ç”»ã«ã¤ã„ã¦å‹é”ã¨è©±ã—ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨æ˜ ç”»ã«ã¤ã„ã¦è©±ã—åˆã†å‹é”ã§ã™ã€‚æœ€è¿‘ã®æ˜ ç”»ã€å¥½ããªã‚¸ãƒ£ãƒ³ãƒ«ã€ä¿³å„ªãªã©ã«ã¤ã„ã¦è©±ã—ã¦ãã ã•ã„ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè‹±èªã§æ„è¦‹ã‚’è¡¨ç¾ã™ã‚‹ã®ã‚’ä¿ƒã—ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯å‹é”ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ã¨æ˜ ç”»ã«ã¤ã„ã¦è©±ã—åˆã£ã¦ã„ã¾ã™ã€‚æ˜ ç”»ã€ã‚¸ãƒ£ãƒ³ãƒ«ã€ä¿³å„ªãªã©ã«ã¤ã„ã¦ç°¡æ½”ã«æ„è¦‹ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["æœ€è¿‘ä½•ã‹è‰¯ã„æ˜ ç”»ã‚’è¦‹ã¾ã—ãŸã‹ï¼Ÿ", "ã©ã‚“ãªæ˜ ç”»ãŒå¥½ãã§ã™ã‹ï¼Ÿ", "æœ€è¿‘[æ˜ ç”»ã‚¿ã‚¤ãƒˆãƒ«]ã‚’è¦‹ã¾ã—ãŸ..."],
          starters_userAsOther: ["ãã‚Œã§ã€ãŠã™ã™ã‚ã®æ–°ã—ã„æ˜ ç”»ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "è¦‹ã‚‹è‰¯ã„æ˜ ç”»ã‚’æ¢ã—ã¦ã„ã¾ã™ã€ä½•ã‹ã‚¢ã‚¤ãƒ‡ã‚¢ã¯ï¼Ÿ", "[æ˜ ç”»ã‚¿ã‚¤ãƒˆãƒ«]ã«ã¤ã„ã¦ã©ã†æ€ã„ã¾ã—ãŸã‹ï¼Ÿ"] },
        { id: "talking_about_music", title: "éŸ³æ¥½ã®å¥½ã¿ã‚’å…±æœ‰ã™ã‚‹ ğŸ¶", description: "å¥½ããªéŸ³æ¥½ã‚¸ãƒ£ãƒ³ãƒ«ã€æ­Œæ‰‹ã€æ›²ã«ã¤ã„ã¦è©±ã—ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯éŸ³æ¥½ã«ã¤ã„ã¦è©±ã™å‹é”ã§ã™ã€‚å¥½ããªã‚¸ãƒ£ãƒ³ãƒ«ã€ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆã€æ›²ã€ã‚³ãƒ³ã‚µãƒ¼ãƒˆãªã©ã«ã¤ã„ã¦è©±ã—åˆã£ã¦ãã ã•ã„ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè‹±èªã§éŸ³æ¥½ã®å¥½ã¿ã‚’å…±æœ‰ã™ã‚‹ã®ã‚’æ‰‹ä¼ã£ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯å‹é”ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ã¨éŸ³æ¥½ã«ã¤ã„ã¦è©±ã—ã¦ã„ã¾ã™ã€‚éŸ³æ¥½ã®å¥½ã¿ã€å¥½ããªã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆã€æ›²ãªã©ã‚’ç°¡æ½”ã«å…±æœ‰ã—ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["ã©ã‚“ãªéŸ³æ¥½ãŒå¥½ãã§ã™ã‹ï¼Ÿ", "å¥½ããªæ­Œæ‰‹ã¯èª°ã§ã™ã‹ï¼Ÿ", "[ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆ]ã®æ–°ã—ã„æ›²ã‚’èãã¾ã—ãŸã‹ï¼Ÿ"],
          starters_userAsOther: ["ç§ã¯ã„ã¤ã‚‚æ–°ã—ã„éŸ³æ¥½ã‚’æ¢ã—ã¦ã„ã¾ã™ã€‚ä½•ã‹ãŠã™ã™ã‚ã¯ï¼Ÿ", "æœ€è¿‘ä½•ã‚’èã„ã¦ã„ã¾ã™ã‹ï¼Ÿ", "[ã‚¸ãƒ£ãƒ³ãƒ«/ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆ]ã¯å¥½ãã§ã™ã‹ï¼Ÿ"] },
        { id: "discussing_books", title: "æœ¬ã«ã¤ã„ã¦ä¼šè©±ã™ã‚‹ ğŸ“š", description: "èª­ã‚“ã æœ¬ã‚„å¥½ããªä½œå®¶ã€ã‚¸ãƒ£ãƒ³ãƒ«ã«ã¤ã„ã¦è©±ã—ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯æœ¬å¥½ãã®ä»²é–“ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯èª­ã‚“ã æœ¬ã€å¥½ããªä½œå®¶ã€ã‚¸ãƒ£ãƒ³ãƒ«ã«ã¤ã„ã¦è©±ã—åˆã„ãŸãŒã£ã¦ã„ã¾ã™ã€‚ã‚ãªãŸã®è€ƒãˆã‚’å…±æœ‰ã—ã€ç›¸æ‰‹ã®ã“ã¨ã‚’å°‹ã­ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯æœ¬å¥½ãã®ä»²é–“ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ã¨æœ¬ã«ã¤ã„ã¦è©±ã—åˆã£ã¦ã„ã¾ã™ã€‚èª­ã‚“ã æœ¬ã€å¥½ããªä½œå®¶ã€ã‚¸ãƒ£ãƒ³ãƒ«ã«ã¤ã„ã¦ç°¡æ½”ã«è©±ã—ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["ä»Šä½•ã‚’èª­ã‚“ã§ã„ã¾ã™ã‹ï¼Ÿ", "å¥½ããªä½œå®¶ã¯ã„ã¾ã™ã‹ï¼Ÿ", "ç´ æ™´ã‚‰ã—ã„æœ¬ã‚’èª­ã¿çµ‚ãˆãŸã¨ã“ã‚ã§ã™..."],
          starters_userAsOther: ["æœ€è¿‘ä½•ã‹è‰¯ã„æœ¬ã‚’èª­ã¿ã¾ã—ãŸã‹ï¼Ÿ", "æ–°ã—ã„æœ¬ã‚’æ¢ã—ã¦ã„ã¾ã™ã€‚ä½•ã‹ææ¡ˆã¯ï¼Ÿ", "ã©ã‚“ãªæœ¬ãŒå¥½ãã§ã™ã‹ï¼Ÿ"] },
        { id: "talking_about_sports", title: "ã‚¹ãƒãƒ¼ãƒ„ã«ã¤ã„ã¦è©±ã™ âš½", description: "å¥½ããªã‚¹ãƒãƒ¼ãƒ„ã€ãƒãƒ¼ãƒ ã€é¸æ‰‹ã«ã¤ã„ã¦è©±ã—ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯ã‚¹ãƒãƒ¼ãƒ„æ„›å¥½å®¶ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã‚¹ãƒãƒ¼ãƒ„ã«ã¤ã„ã¦è©±ã—ãŸãŒã£ã¦ã„ã¾ã™ã€‚å¥½ããªã‚¹ãƒãƒ¼ãƒ„ã€ãƒãƒ¼ãƒ ã€é¸æ‰‹ã€æœ€è¿‘ã®è©¦åˆãªã©ã«ã¤ã„ã¦è©±ã—åˆã£ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯æ„›å¥½å®¶ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ã¨ã‚¹ãƒãƒ¼ãƒ„ã«ã¤ã„ã¦è©±ã—ã¦ã„ã¾ã™ã€‚å¥½ããªã‚¹ãƒãƒ¼ãƒ„ã€ãƒãƒ¼ãƒ ã€é¸æ‰‹ã€æœ€è¿‘ã®è©¦åˆã«ã¤ã„ã¦ç°¡æ½”ã«è©±ã—åˆã£ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["æ˜¨å¤œã®è©¦åˆã‚’è¦‹ã¾ã—ãŸã‹ï¼Ÿ", "å¥½ããªãƒãƒ¼ãƒ ã¯ã©ã“ã§ã™ã‹ï¼Ÿ", "ç§ã¯[ã‚¹ãƒãƒ¼ãƒ„]ã‚’ã™ã‚‹ã®ãŒå¤§å¥½ãã§ã™"],
          starters_userAsOther: ["æ˜¨å¤œã¯ã™ã”ã„è©¦åˆã§ã—ãŸã­ï¼Ÿ", "[ã‚¹ãƒãƒ¼ãƒ„/ãƒãƒ¼ãƒ ]ã®ãƒ•ã‚¡ãƒ³ã§ã™ã‹ï¼Ÿ", "ã©ã‚“ãªã‚¹ãƒãƒ¼ãƒ„ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ"] }
    ]},
    { category: "ç¤¾äº¤æ´»å‹•", items: [
        { id: "meeting_new_people", title: "æ–°ã—ã„äººã¨ã‚¹ãƒ¢ãƒ¼ãƒ«ãƒˆãƒ¼ã‚¯ ğŸ‘‹", description: "ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã‚„é›†ã¾ã‚Šã§åˆã‚ã¦ä¼šã£ãŸäººã¨è»½ã„ä¼šè©±ã‚’ã—ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç¤¾äº¤ã‚¤ãƒ™ãƒ³ãƒˆã§ä¼šã£ãŸã°ã‹ã‚Šã®äººã§ã™ã€‚ã‚¹ãƒ¢ãƒ¼ãƒ«ãƒˆãƒ¼ã‚¯ã‚’ã—ã€èˆˆå‘³ã€ä»•äº‹ãªã©ã«ã¤ã„ã¦å°‹ã­ã¦ã€æ–°ã—ã„äººã¨ã®ä¼šè©±ã‚’å§‹ã‚ã‚‹ç·´ç¿’ã‚’æ‰‹ä¼ã£ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯ç¤¾äº¤ã‚¤ãƒ™ãƒ³ãƒˆã§èª°ã‹ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ã«ä¼šã£ãŸã°ã‹ã‚Šã§ã™ã€‚ã‚¹ãƒ¢ãƒ¼ãƒ«ãƒˆãƒ¼ã‚¯ã‚’ã—ã€èˆˆå‘³ã‚’å…±æœ‰ã—ãŸã‚Šã€ç›¸æ‰‹ã®ã“ã¨ã‚’ç°¡æ½”ã«å°‹ã­ãŸã‚Šã—ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["ã“ã‚“ã«ã¡ã¯ã€[ã‚ãªãŸã®åå‰]ã§ã™ã€‚ãŠä¼šã„ã§ãã¦å¬‰ã—ã„ã§ã™", "ãŠä»•äº‹ã¯ä½•ã‚’ã•ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ", "ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ¥½ã—ã‚“ã§ã„ã¾ã™ã‹ï¼Ÿ"],
          starters_userAsOther: ["ã“ã‚“ã«ã¡ã¯ï¼ã¾ã ãŠä¼šã„ã—ã¦ã„ãªã„ã¨æ€ã„ã¾ã™ã€‚[ã‚ãªãŸã®åå‰]ã§ã™", "ç´ æ™´ã‚‰ã—ã„ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã­ï¼Ÿ", "ã“ã‚“ã«ã¡ã¯ã€ã”ä¸€ç·’ã—ã¦ã‚‚ã„ã„ã§ã™ã‹ï¼Ÿ"] },
        { id: "inviting_friend", title: "å‹é”ã‚’èª˜ã†ï¼ˆé£Ÿäº‹ã€æ˜ ç”»ãªã©ï¼‰ğŸ“§", description: "å‹é”ã«é£Ÿäº‹ã‚„æ˜ ç”»é‘‘è³ãªã©ã‚’ææ¡ˆã—ã€ç´„æŸã‚’å–ã‚Šä»˜ã‘ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å‹é”ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯é£Ÿäº‹ã€æ˜ ç”»ã€ã¾ãŸã¯ä»–ã®æ´»å‹•ã«ã‚ãªãŸã‚’èª˜ã„ãŸãŒã£ã¦ã„ã¾ã™ã€‚æ‹›å¾…ã«å¿œç­”ã—ã€è¨ˆç”»ã«ã¤ã„ã¦è©±ã—åˆã„ã€è©³ç´°ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯å‹é”ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ã‚’èª˜ã„ãŸãŒã£ã¦ã„ã¾ã™ã€‚æ‹›å¾…ã‚’ã—ã€è¨ˆç”»ã‚’ææ¡ˆã—ã€è©³ç´°ã‚’ç°¡æ½”ã«ç¢ºèªã—ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["é‡‘æ›œæ—¥ã«å¤•é£Ÿã‚’é£Ÿã¹ã«è¡Œãæ™‚é–“ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "ä¸€ç·’ã«æ˜ ç”»ã‚’è¦‹ã«è¡Œãã¾ã›ã‚“ã‹ï¼Ÿ", "æ¥é€±ã®ã„ã¤ã‹ä¼šã„ã¾ã—ã‚‡ã†"],
          starters_userAsOther: ["ã­ãˆã€å¾Œã§ä½•ã—ã¦ã‚‹ï¼Ÿ", "[æ´»å‹•]ã‚’è€ƒãˆã¦ã„ãŸã‚“ã ã‘ã©ã€å‚åŠ ã™ã‚‹ï¼Ÿ", "ãã‚ãã‚ä¼šã†ã¹ãã ã­"] },
        { id: "accepting_declining_invitation", title: "æ‹›å¾…ã‚’å—ã‘å…¥ã‚Œã‚‹/æ–­ã‚‹ âœ…âŒ", description: "å‹é”ã®æ‹›å¾…ã‚’å—ã‘å…¥ã‚ŒãŸã‚Šã€ä¸å¯§ã«æ–­ã‚‹æ–¹æ³•ã‚’ç·´ç¿’ã—ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ã‚¤ãƒ™ãƒ³ãƒˆã«æ‹›å¾…ã—ã¾ã—ãŸã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯æ‹›å¾…ã‚’ä¸å¯§ã«å—ã‘å…¥ã‚ŒãŸã‚Šæ–­ã£ãŸã‚Šã™ã‚‹ç·´ç¿’ã‚’ã—ã¾ã™ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã£ã¦ã‚¤ãƒ™ãƒ³ãƒˆã«æ‹›å¾…ã•ã‚Œã¾ã—ãŸã€‚æ‹›å¾…ã‚’ä¸å¯§ã«å—ã‘å…¥ã‚ŒãŸã‚Šæ–­ã£ãŸã‚Šã™ã‚‹ç·´ç¿’ã‚’ç°¡æ½”ã«ã—ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["æ‹›å¾…ã—ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ï¼ãœã²è¡ŒããŸã„ã§ã™", "ãã‚Œã¯ç´ æ™´ã‚‰ã—ã„ã§ã™ãŒã€æ®‹å¿µãªãŒã‚‰ä»–ã®äºˆå®šãŒã‚ã‚Šã¾ã™", "æ‹›å¾…ã«æ„Ÿè¬ã—ã¾ã™ãŒã€è¡Œã‘ãªã„ã¨æ€ã„ã¾ã™"],
          starters_userAsOther: ["åœŸæ›œæ—¥ã«é›†ã¾ã‚Šã‚’ã™ã‚‹ã‚“ã ã‘ã©ã€æ¥ã‚‹ï¼Ÿ", "ä»Šé€±æœ«ã«æ˜ ç”»ã‚’è¦‹ã«è¡Œã‹ãªã„ï¼Ÿ", "[ã‚¤ãƒ™ãƒ³ãƒˆ]ã‚’è¨ˆç”»ã—ã¦ã„ã‚‹ã‚“ã ã€æ¥ã‚Œã‚‹ã¨ã„ã„ãªï¼"] }
    ]},
    { category: "å•é¡Œè§£æ±ºãƒ»ãƒªã‚¯ã‚¨ã‚¹ãƒˆ", items: [
        { id: "returning_item", title: "å•†å“ã®è¿”å“/äº¤æ› ğŸ›ï¸", description: "åº—ã§è³¼å…¥ã—ãŸå•†å“ã‚’è¿”å“ã¾ãŸã¯äº¤æ›ãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹çŠ¶æ³ã§ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯åº—å“¡ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è³¼å…¥ã—ãŸå•†å“ã‚’è¿”å“ã¾ãŸã¯äº¤æ›ã—ãŸãŒã£ã¦ã„ã¾ã™ã€‚ç†ç”±ã€ãƒ¬ã‚·ãƒ¼ãƒˆã‚’å°‹ã­ã€åº—ã®ãƒãƒªã‚·ãƒ¼ã«å¾“ã£ã¦æ¡ˆå†…ã—ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯åº—ã§å•†å“ã‚’è¿”å“ã¾ãŸã¯äº¤æ›ã—ãŸãŒã£ã¦ã„ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯åº—å“¡ã§ã™ã€‚ç†ç”±ã‚’èª¬æ˜ã—ã€ç°¡æ½”ã«ãƒ—ãƒ­ã‚»ã‚¹ã«å¾“ã£ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["ã“ã®å•†å“ã‚’è¿”å“ã—ãŸã„ã®ã§ã™ãŒ", "ã“ã‚Œã‚’åˆ¥ã®ã‚µã‚¤ã‚ºã¨äº¤æ›ã§ãã¾ã™ã‹ï¼Ÿ", "è²·ã£ãŸå•†å“ã«å•é¡ŒãŒã‚ã‚Šã¾ã™"],
          starters_userAsOther: ["ã“ã‚“ã«ã¡ã¯ã€ä»Šæ—¥ã¯ã©ã®ã‚ˆã†ãªã”ç”¨ä»¶ã§ã™ã‹ï¼Ÿ", "ãƒ¬ã‚·ãƒ¼ãƒˆã¯ãŠæŒã¡ã§ã™ã‹ï¼Ÿ", "å•†å“ã®ä½•ãŒå•é¡Œã®ã‚ˆã†ã§ã™ã‹ï¼Ÿ"] },
        { id: "tech_support", title: "æŠ€è¡“ã‚µãƒãƒ¼ãƒˆã«å•ã„åˆã‚ã›ã‚‹ ğŸ’»", description: "è£½å“ä½¿ç”¨ä¸­ã«å•é¡ŒãŒç™ºç”Ÿã—ã€æŠ€è¡“ã‚µãƒãƒ¼ãƒˆãƒãƒ¼ãƒ ã«å•ã„åˆã‚ã›ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯æŠ€è¡“ã‚µãƒãƒ¼ãƒˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è£½å“ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã®å•é¡Œã«ã¤ã„ã¦é›»è©±ã—ã¦ã„ã¾ã™ã€‚å•é¡Œã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’æ‰‹ä¼ã†ã‹ã€å•é¡Œã‚’ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ãƒˆã—ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯è£½å“ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã®å•é¡Œã«ã¤ã„ã¦æŠ€è¡“ã‚µãƒãƒ¼ãƒˆã«é›»è©±ã—ã¦ã„ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã‚µãƒãƒ¼ãƒˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§ã™ã€‚å•é¡Œã‚’èª¬æ˜ã—ã€ç°¡æ½”ã«æ”¯æ´ã‚’æ±‚ã‚ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["[è£½å“/ã‚µãƒ¼ãƒ“ã‚¹]ã«å•é¡ŒãŒã‚ã‚Šã¾ã™", "ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆãŒå‹•ä½œã—ã¾ã›ã‚“", "ã“ã®ã‚¨ãƒ©ãƒ¼ã‚’ä¿®æ­£ã™ã‚‹ã®ã‚’æ‰‹ä¼ã£ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ"],
          starters_userAsOther: ["æŠ€è¡“ã‚µãƒãƒ¼ãƒˆã«ãŠé›»è©±ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€[ã‚ãªãŸã®åå‰]ã§ã™ã€‚ã©ã®ã‚ˆã†ãªãŠæ‰‹ä¼ã„ãŒã§ãã¾ã™ã‹ï¼Ÿ", "ã©ã®ã‚ˆã†ãªå•é¡ŒãŒç™ºç”Ÿã—ã¦ã„ã‚‹ã‹èª¬æ˜ã—ã¦ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ", "ãƒ‡ãƒã‚¤ã‚¹ã‚’å†èµ·å‹•ã—ã¦ã¿ã¾ã—ãŸã‹ï¼Ÿ"] },
        { id: "making_complaint", title: "è‹¦æƒ…ã‚’ç”³ã—ç«‹ã¦ã‚‹ï¼ˆãƒ›ãƒ†ãƒ«ã€ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ãªã©ï¼‰ğŸ˜ ", description: "ã‚µãƒ¼ãƒ“ã‚¹ã‚„è£½å“ã«å¯¾ã™ã‚‹ä¸æº€ã‚’ä¸å¯§ã«è¡¨ç¾ã—ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã¾ãŸã¯ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒ¼ãƒ“ã‚¹æ‹…å½“è€…ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã‚µãƒ¼ãƒ“ã‚¹ã‚„è£½å“ã«ã¤ã„ã¦è‹¦æƒ…ãŒã‚ã‚Šã¾ã™ã€‚å½¼ã‚‰ã®æ‡¸å¿µã‚’èãã€å•é¡Œã‚’è§£æ±ºã—ã‚ˆã†ã¨ã—ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯ã‚µãƒ¼ãƒ“ã‚¹ã‚„è£½å“ã«ã¤ã„ã¦è‹¦æƒ…ãŒã‚ã‚Šã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã¾ãŸã¯ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒ¼ãƒ“ã‚¹æ‹…å½“è€…ã§ã™ã€‚ä¸æº€ã‚’ä¸å¯§ã‹ã¤ç°¡æ½”ã«è¡¨ç¾ã—ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["ç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“ãŒã€ï½ã«ã¤ã„ã¦è‹¦æƒ…ãŒã‚ã‚Šã¾ã™", "å—ã‘ãŸã‚µãƒ¼ãƒ“ã‚¹ã«æº€è¶³ã—ã¦ã„ã¾ã›ã‚“", "ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã¨è©±ã›ã¾ã™ã‹ï¼Ÿ"],
          starters_userAsOther: ["ã”å¿ƒé…ãŒã‚ã‚‹ã“ã¨ã‚’ç†è§£ã—ã¦ã„ã¾ã™ã€‚ä½•ãŒèµ·ã“ã£ãŸã‹æ•™ãˆã¦ãã ã•ã„", "ã”æº€è¶³ã„ãŸã ã‘ãªãã¦ç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“ã€‚ã©ã®ã‚ˆã†ã«è§£æ±ºã§ãã¾ã™ã‹ï¼Ÿ", "ã“ã‚Œã‚’ç§ã®æ³¨æ„ã«æŒã£ã¦ãã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™"] }
    ]},
    { category: "å¥åº·ãƒ»åŒ»ç™‚", items: [
        { id: "hospital_visit", title: "ç—…é™¢ã‚’è¨ªã‚Œã‚‹ï¼ˆä¸€èˆ¬è¨ºç™‚ï¼‰ğŸ¥", description: "åŒ»å¸«ã‚„çœ‹è­·å¸«ã«ç—‡çŠ¶ã‚’èª¬æ˜ã—ã€è¨ºç™‚é–¢é€£ã®ä¼šè©±ã‚’ã—ã¾ã™ã€‚AIã¯åŒ»ç™‚å¾“äº‹è€…ã®å½¹å‰²ã‚’æ¼”ã˜ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯ç—…é™¢ã®åŒ»å¸«ã¾ãŸã¯çœ‹è­·å¸«ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ç—‡çŠ¶ã‚’èª¬æ˜ã™ã‚‹æ‚£è€…ã§ã™ã€‚ä¸€åº¦ã«1ã¤ãšã¤æ˜ç¢ºãªè³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰ã‹ã¤å°‚é–€çš„ã«è¿”ç­”ã—ã¦ãã ã•ã„ã€‚ä¸€åº¦ã«å¤šãã®è³ªå•ã‚’ã—ãªã„ã§ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯åŒ»å¸«/çœ‹è­·å¸«ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ã‚’è¨ªã‚Œã‚‹æ‚£è€…ã§ã™ã€‚ç—‡çŠ¶ã‚’èª¬æ˜ã—ãŸã‚Šã€ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’ç°¡æ½”ã«æ±‚ã‚ãŸã‚Šã—ã¦ãã ã•ã„ã€‚ä¸€åº¦ã«1ã¤ã®è³ªå•ã«ç­”ãˆã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["åŒ»å¸«ã«è¨ºã¦ã‚‚ã‚‰ã„ãŸã„ã§ã™ã€‚ä½“èª¿ãŒè‰¯ãã‚ã‚Šã¾ã›ã‚“", "æŒç¶šçš„ãªå’³ã¨å–‰ã®ç—›ã¿ãŒã‚ã‚Šã¾ã™", "è¶³é¦–ã‚’æ»æŒ«ã—ãŸã‹ã‚‚ã—ã‚Œã¾ã›ã‚“"],
          starters_userAsOther: ["ã“ã‚“ã«ã¡ã¯ã€ä»Šæ—¥ã¯ã©ã®ã‚ˆã†ãªå•é¡ŒãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ã€‚ã©ã®ã‚ˆã†ãªãŠæ‰‹ä¼ã„ãŒã§ãã¾ã™ã‹ï¼Ÿ", "ä½•ãŒå¿ƒé…ã‹æ•™ãˆã¦ãã ã•ã„"] },
        { id: "dentist_visit", title: "æ­¯ç§‘ã‚’è¨ªã‚Œã‚‹ ğŸ¦·", description: "æ­¯ç§‘åŒ»å¸«ã‚„æ­¯ç§‘è¡›ç”Ÿå£«ã«æ­¯ã®å•é¡Œã‚’èª¬æ˜ã—ãŸã‚Šã€å®šæœŸæ¤œè¨ºé–¢é€£ã®ä¼šè©±ã‚’ã—ã¾ã™ã€‚AIã¯æ­¯ç§‘åŒ»ç™‚å¾“äº‹è€…ã®å½¹å‰²ã‚’æ¼”ã˜ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯æ­¯ç§‘åŒ»å¸«ã¾ãŸã¯æ­¯ç§‘è¡›ç”Ÿå£«ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯æ‚£è€…ã§ã™ã€‚æ­¯ã®å•é¡Œã‚„ãƒ‹ãƒ¼ã‚ºã«ã¤ã„ã¦å°‹ã­ã¦ãã ã•ã„ã€‚è³ªå•ã¯ç„¦ç‚¹ã‚’çµã£ã¦ç°¡æ½”ã«ï¼ˆ1ã‚¿ãƒ¼ãƒ³ã«1ï½2æ–‡ï¼‰ã—ã¦ãã ã•ã„ã€‚ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯æ­¯ç§‘ã‚¯ãƒªãƒ‹ãƒƒã‚¯ã®æ‚£è€…ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯æ­¯ç§‘åŒ»å¸«/è¡›ç”Ÿå£«ã§ã™ã€‚æ­¯ã®æ‡¸å¿µã‚„è¨ªå•ã®ç†ç”±ã‚’ç°¡æ½”ã«èª¬æ˜ã—ã¦ãã ã•ã„ã€‚ä¸€åº¦ã«1ã¤ã®è³ªå•ã«ç­”ãˆã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["æ­¯ãŒç—›ãã¦ã€äºˆç´„ã‚’å–ã‚ŠãŸã„ã§ã™", "6ãƒ¶æœˆã®æ¤œè¨ºã¨ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã«æ¥ã¾ã—ãŸ", "ã“ã®æ­¯ãŒæœ€è¿‘å†·ãŸã„ã‚‚ã®ã«ã¨ã¦ã‚‚æ•æ„Ÿã§ã™"],
          starters_userAsOther: ["ã“ã‚“ã«ã¡ã¯ã€å½“æ­¯ç§‘ã‚¯ãƒªãƒ‹ãƒƒã‚¯ã¸ã‚ˆã†ã“ãã€‚ä»Šæ—¥ã¯ã©ã®ã‚ˆã†ãªãŠæ‰‹ä¼ã„ãŒã§ãã¾ã™ã‹ï¼Ÿ", "ä½•ã‹æ¥é™¢ã•ã‚ŒãŸã”ç”¨ä»¶ã¯ï¼Ÿ", "æ¤œè¨ºã§ã™ã‹ã€ãã‚Œã¨ã‚‚ç‰¹å®šã®å•é¡Œã§ã™ã‹ï¼Ÿ"] }
    ]},
    { category: "ç‰¹åˆ¥ãªæ©Ÿä¼š", items: [
        { id: "birthday_party", title: "èª•ç”Ÿæ—¥ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã§ã®ä¼šè©± ğŸ‰", description: "èª•ç”Ÿæ—¥ã®ãŠç¥ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¼ãˆã€ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã§ä¼šè©±ã—ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯èª•ç”Ÿæ—¥ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã®ã‚²ã‚¹ãƒˆã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚‚ã‚²ã‚¹ãƒˆã¾ãŸã¯èª•ç”Ÿæ—¥ã®äººã§ã™ã€‚è»½ã„ä¼šè©±ã‚’ã—ã€è‰¯ã„é¡˜ã„ã‚’æä¾›ã—ã¦ãã ã•ã„ã€‚ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰è¿”ç­”ã—ã€ä¸€åº¦ã«1ã¤ã®è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯èª•ç”Ÿæ—¥ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã«ã„ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯åˆ¥ã®ã‚²ã‚¹ãƒˆã¾ãŸã¯èª•ç”Ÿæ—¥ã®äººã§ã™ã€‚ä¼šè©±ã‚’ã—ã€ç°¡æ½”ã«è‰¯ã„é¡˜ã„ã‚’æä¾›ã—ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["ãŠèª•ç”Ÿæ—¥ãŠã‚ã§ã¨ã†ï¼", "ç´ æ™´ã‚‰ã—ã„ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã§ã™ã­ï¼", "ç‰¹åˆ¥ãªæ—¥ã‚’æ¥½ã—ã‚“ã§ã„ã¾ã™ã‹ï¼Ÿ"],
          starters_userAsOther: ["ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã«æ¥ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ï¼", "æ¥ã¦ãã‚Œã¦æœ¬å½“ã«å¬‰ã—ã„ï¼", "æ¥½ã—ã‚“ã§ã„ã¾ã™ã‹ï¼Ÿ"] },
        { id: "congratulating_someone", title: "ãŠç¥ã„ã‚’è¡¨ç¾ã™ã‚‹ ğŸ¥³", description: "ä»–ã®äººã®è‰¯ã„ã“ã¨ï¼ˆæ˜‡é€²ã€å’æ¥­ãªã©ï¼‰ã‚’ãŠç¥ã„ã—ã¾ã™ã€‚",
          baseContext: "ã‚ãªãŸã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å‹äººã¾ãŸã¯åŒåƒšã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã‚ãªãŸã¾ãŸã¯ä»–ã®èª°ã‹ã®æˆæœã‚’ãŠç¥ã„ã—ãŸãŒã£ã¦ã„ã¾ã™ã€‚é©åˆ‡ã‹ã¤ç°¡æ½”ã«ï¼ˆ1ï½2æ–‡ï¼‰å¿œç­”ã—ã¦ãã ã•ã„ã€‚ã™ã§ã«å›ç­”ã‚’å¾—ãŸè³ªå•ã¯ã—ãªã„ã§ãã ã•ã„ã€‚",
          baseContext_swapped: "ã‚ãªãŸã¯å‹äººã¾ãŸã¯åŒåƒšï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ã®æˆæœã‚’ãŠç¥ã„ã—ãŸãŒã£ã¦ã„ã¾ã™ã€‚ç°¡æ½”ã«ãŠç¥ã„ã‚’è¡¨ç¾ã—ã¦ãã ã•ã„ã€‚",
          starters_userAsPrimary: ["æ˜‡é€²ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼", "ç´ æ™´ã‚‰ã—ã„ãƒ‹ãƒ¥ãƒ¼ã‚¹ã§ã™ã­ï¼ã‚ˆãã‚„ã‚Šã¾ã—ãŸ", "æœ¬å½“ã«å¬‰ã—ã„ã§ã™ï¼"],
          starters_userAsOther: ["æœ¬å½“ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼", "ãã‚Œã¯æœ¬å½“ã«æ„Ÿè¬ã—ã¦ã„ã¾ã™", "ã‚ãªãŸã‹ã‚‰ãã‚Œã‚’èãã“ã¨ã¯æœ¬å½“ã«æ„å‘³ãŒã‚ã‚Šã¾ã™"] }
    ]},
    { category: "ã‚«ã‚¹ã‚¿ãƒ è¨­å®š", isCustomCategory: true, items: [
        { id: "custom", title: "è‡ªåˆ†ã§å…¥åŠ› âœ¨", description: "ç·´ç¿’ã—ãŸã„çŠ¶æ³ã‚„ä¼šè©±ã®ãƒˆãƒ”ãƒƒã‚¯ã‚’ä¸‹ã«è©³ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„ã€‚", 
          baseContext: "", 
          baseContext_swapped: "", 
          starters_userAsPrimary: ["[ã‚ãªãŸã®ãƒˆãƒ”ãƒƒã‚¯]ã«ã¤ã„ã¦è©±ã—ã¾ã—ã‚‡ã†", "[ã‚ãªãŸã®çŠ¶æ³]ã«ã¤ã„ã¦ã®è­°è«–ã‚’ç·´ç¿’ã—ãŸã„ã§ã™", "[ã‚ãªãŸã®ã‚·ãƒŠãƒªã‚ª]ã«ã¤ã„ã¦ã®ä¼šè©±ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã§ãã¾ã™ã‹ï¼Ÿ"], 
          starters_userAsOther: ["ã‚ã‹ã‚Šã¾ã—ãŸã€ã‚ãªãŸãŒèª¬æ˜ã—ãŸã‚«ã‚¹ã‚¿ãƒ ã‚·ãƒŠãƒªã‚ªã®æº–å‚™ãŒã§ãã¦ã„ã¾ã™ã€‚ç§ã®æœ€åˆã®ã‚»ãƒªãƒ•ã¯ä½•ã§ã™ã‹ï¼Ÿ", "ã‚«ã‚¹ã‚¿ãƒ ã‚·ãƒŠãƒªã‚ªã‚’ç†è§£ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€äººã®äººç‰©ã¨ã—ã¦ã©ã®ã‚ˆã†ã«å§‹ã‚ã‚‹ã¹ãã§ã™ã‹ï¼Ÿ", "ã‚«ã‚¹ã‚¿ãƒ ãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ã‚¤ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ã€‚ã‚ãªãŸã®èª¬æ˜ã«ã‚ˆã‚‹ã¨ç§ã®å½¹å‰²ã¯ä½•ã§ã™ã‹ï¼Ÿ"] }
    ]}
];

const ja_UI_TEXT = {
    appTitle: "SpeakUp AI",
    suggestReplies: "è¿”ä¿¡ææ¡ˆ",
    analyzeSentence: "æ–‡ç« åˆ†æ",
    roleSwapButtonText: "å½¹å‰²äº¤æ›",
    loading: "èª­ã¿è¾¼ã¿ä¸­...",
    aiResponseError: "ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ã€‚AIå¿œç­”ã®ç”Ÿæˆä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸï¼š",
    errorMessageSuggestions: "ææ¡ˆã®å–å¾—ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚",
    errorMessageAnalysis: "åˆ†æä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚",
    noUserMessageForAnalysis: "åˆ†æã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ã¾ãšè‹±èªã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã¦ãã ã•ã„ã€‚",
    suggestionsAfterAiResponse: "AIå¿œç­”ã®å¾Œã«ææ¡ˆã‚’è¦æ±‚ã—ã¦ãã ã•ã„ã€‚",
    scenarioChangeLoadingAlert: "AIãŒå¿œç­”ä¸­ã¯ã‚·ãƒŠãƒªã‚ªã‚’å¤‰æ›´ã§ãã¾ã›ã‚“ã€‚",
    newConversationLoadingAlert: "AIãŒå¿œç­”ä¸­ã¯æ–°ã—ã„ä¼šè©±ã‚’é–‹å§‹ã§ãã¾ã›ã‚“ã€‚",
    roleChangeAlert: (role) => `å½¹å‰²ãŒå¤‰æ›´ã•ã‚Œã¾ã—ãŸï¼ã‚ãªãŸã¯ä»Š${role}ã§ã™ã€‚`,
    newConversationAlert: (scenario) => `ã€Œ${scenario}ã€ã‚·ãƒŠãƒªã‚ªã§æ–°ã—ã„ä¼šè©±ã‚’é–‹å§‹ã—ã¾ã™ï¼`,
    customScenarioInputRequired: "ã‚«ã‚¹ã‚¿ãƒ ã‚·ãƒŠãƒªã‚ªã‚’é¸æŠã—ã¾ã—ãŸã€‚ä»¥ä¸‹ã«ç·´ç¿’ã—ãŸã„çŠ¶æ³ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚",
    scenarioTitleCustom: (input) => input ? `âœ¨ ã‚«ã‚¹ã‚¿ãƒ : ${input}` : "âœ¨ ã‚«ã‚¹ã‚¿ãƒ ã‚·ãƒŠãƒªã‚ª",
    customScenarioDescription: "å…¥åŠ›ã—ãŸçŠ¶æ³ã«åˆã‚ã›ã¦AIãŒä¼šè©±ç›¸æ‰‹ã«ãªã‚Šã¾ã™ã€‚",
    customScenarioPlaceholder: "ç·´ç¿’ã—ãŸã„çŠ¶æ³ã‚„ä¼šè©±ã®ãƒˆãƒ”ãƒƒã‚¯ã‚’è©³ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„...",
    starterPhrasePrefix: "ã“ã®ã‚ˆã†ã«å§‹ã‚ã¦ã¿ã¦ãã ã•ã„ï¼š",
    focusTopicPlaceholder: "é›†ä¸­ç·´ç¿’ãƒ†ãƒ¼ãƒï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰",
    guideModalTitle: "SpeakUp AI ä½¿ç”¨ã‚¬ã‚¤ãƒ‰ ğŸš€",
    guideModalConfirmButton: "ã‚ã‹ã‚Šã¾ã—ãŸï¼",
    analysisResultTitle: "âœ¨ æ–‡ç« åˆ†æçµæœ",
    englishFeedbackTitle: "ğŸ“ è‹±èªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼š",
    koreanSummaryTitle: "ğŸ‡¯ğŸ‡µ æ—¥æœ¬èªè¦ç´„ï¼š",
    analysisConfirmButton: "ç¢ºèªã—ã¾ã—ãŸï¼",
    guideP1_html: `<strong>1. ğŸ¤– ã‚·ãƒŠãƒªã‚ªé¸æŠï¼š</strong><br/> ç”»é¢å·¦ä¸Šã®ã‚·ãƒŠãƒªã‚ªãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚`,
    guideP2_html: `<strong>2. ğŸ¯ é›†ä¸­ãƒ†ãƒ¼ãƒï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ï¼š</strong><br/> ç‰¹åˆ¥ã«ç·´ç¿’ã—ãŸã„èªå½™ã‚„è¡¨ç¾ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚`,
    guideP3_html: `<strong>3. ğŸ—£ï¸ ä¼šè©±é–‹å§‹ï¼š</strong><br/> è‹±èªã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦é€ä¿¡ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚`,
    guideP4_header_html: `<strong>4. âœ¨ AIæ©Ÿèƒ½æ´»ç”¨ï¼š</strong>`,
    guideP4_item1_html: `<strong class="text-amber-600">è¿”ä¿¡ææ¡ˆï¼š</strong> AIãŒ3ã¤ã®è¿”ä¿¡ä¾‹ã‚’ææ¡ˆã—ã¾ã™ã€‚`,
    guideP4_item2_html: `<strong class="text-teal-600">æ–‡ç« åˆ†æï¼š</strong> æ–‡æ³•ã€èªå½™ã€è‡ªç„¶ã•ã‚’åˆ†æã—ã¾ã™ã€‚`,
    guideP4_item3_html: `<strong class="text-indigo-600">å½¹å‰²äº¤æ›ï¼š</strong> ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨AIã®å½¹å‰²ã‚’äº¤æ›ã—ã¾ã™ã€‚`,
    guideP5_html: `<strong>5. ğŸ”„ æ–°ã—ã„ä¼šè©±ï¼š</strong><br/> å³ä¸Šã®æ›´æ–°ãƒœã‚¿ãƒ³ã§ä¼šè©±ã‚’ãƒªã‚»ãƒƒãƒˆã§ãã¾ã™ã€‚`
};

// ì–¸ì–´ íŒ© ì •ì˜
const langPacks = {
    'ko': { scenarios: ko_SCENARIO_DATA, ui: ko_UI_TEXT, displayName: "í•œêµ­ì–´" },
    'ja': { scenarios: ja_SCENARIO_DATA, ui: ja_UI_TEXT, displayName: "æ—¥æœ¬èª" },
};

// --- ì•± ì„¤ì • ---
const APP_ID = 'ai-tutor-html-default-v1';
const API_ENDPOINT =
    (window.APP_CONFIG && window.APP_CONFIG.API_ENDPOINT) ||
    (typeof process !== 'undefined' && process.env && process.env.API_ENDPOINT) ||
    "https://magenta-morning-find.glitch.me/generate";

// --- ì•±ì˜ ì „ì—­ ìƒíƒœ ê´€ë¦¬ ---
const appState = {
    currentMessages: [],
    currentScenario: null,
    currentFocusTopic: '',
    currentCustomScenarioInput: '',
    isLoading: false,
    isLoadingSuggestions: false,
    isLoadingAnalysis: false,
    showScenarioPicker: false,
    expandedCategories: {},
    userIsPlayingPrimaryRole: true,
    currentLangCode: '',
    SCENARIO_DATA: null,
    UI_TEXT: null,
    showLanguagePicker: false,
    showJsonMenu: false,
    showSavedDataMenu: false,
    savedAnalyses: [],
};

// --- DOM ìš”ì†Œ ìºì‹± ---
const elements = {};

function initDOMElements() {
    console.log("initDOMElements: DOM ìš”ì†Œ ìºì‹± ì‹œì‘");
    
    elements.scenarioPickerButton = document.getElementById('scenarioPickerButton');
    elements.currentScenarioDisplay = document.getElementById('currentScenarioDisplay');
    elements.scenarioDropdown = document.getElementById('scenarioDropdown');
    elements.headerTitle = document.getElementById('headerTitle');
    elements.newConversationButton = document.getElementById('newConversationButton');

    elements.jsonMenuContainer = document.getElementById('jsonMenuContainer');
    elements.jsonMenuButton = document.getElementById('jsonMenuButton');
    elements.jsonMenuDropdown = document.getElementById('jsonMenuDropdown');
    elements.jsonMenuSave = document.getElementById('jsonMenuSave');
    elements.jsonMenuLoad = document.getElementById('jsonMenuLoad');
    elements.savedDataMenuContainer = document.getElementById('savedDataMenuContainer');
    elements.savedDataMenuButton = document.getElementById('savedDataMenuButton');
    elements.savedDataMenuDropdown = document.getElementById('savedDataMenuDropdown');
    elements.savedDataMenuFavorites = document.getElementById('savedDataMenuFavorites');
    elements.savedDataMenuAnalyses = document.getElementById('savedDataMenuAnalyses');
    elements.importJsonInput = document.getElementById('importJsonInput');
    elements.helpButton = document.getElementById('helpButton');

    elements.languagePickerContainer = document.getElementById('languagePickerContainer');
    elements.languagePickerButton = document.getElementById('languagePickerButton');
    elements.currentLanguageDisplay = document.getElementById('currentLanguageDisplay');
    elements.languageDropdown = document.getElementById('languageDropdown');

    elements.scenarioDescriptionArea = document.getElementById('scenarioDescriptionArea');
    elements.scenarioTitleElem = document.getElementById('scenarioTitle');
    elements.scenarioDescriptionElem = document.getElementById('scenarioDescription');
    elements.starterPhrasesContainer = document.getElementById('starterPhrasesContainer');
    elements.focusTopicGroup = document.getElementById('focusTopicGroup');
    elements.focusTopicInput = document.getElementById('focusTopicInput');
    elements.customScenarioGroup = document.getElementById('customScenarioGroup');
    elements.customScenarioInputElem = document.getElementById('customScenarioInput');

    elements.messagesContainer = document.getElementById('messagesContainer');
    elements.userInputElem = document.getElementById('userInput');
    elements.sendMessageButton = document.getElementById('sendMessageButton');

    elements.suggestedRepliesContainer = document.getElementById('suggestedRepliesContainer');
    elements.suggestedRepliesList = document.getElementById('suggestedRepliesList');
    elements.suggestRepliesButton = document.getElementById('suggestRepliesButton');
    elements.suggestRepliesButtonText = document.getElementById('suggestRepliesButtonText');

    elements.analyzeSentenceButton = document.getElementById('analyzeSentenceButton');
    elements.analyzeSentenceButtonText = document.getElementById('analyzeSentenceButtonText');

    elements.roleSwapButton = document.getElementById('roleSwapButton');
    elements.roleSwapButtonText = document.getElementById('roleSwapButtonText');

    elements.guideModal = document.getElementById('guideModal');
    elements.guideModalContent = document.getElementById('guideModalContent');
    elements.closeGuideModalButton = document.getElementById('closeGuideModalButton');
    elements.confirmGuideModalButton = document.getElementById('confirmGuideModalButton');

    elements.analysisModal = document.getElementById('analysisModal');
    elements.analysisModalContent = document.getElementById('analysisModalContent');
    elements.englishAnalysisResultDiv = document.querySelector('#englishAnalysisResult div');
    elements.koreanAnalysisResultDiv = document.querySelector('#koreanAnalysisResult div');
    elements.closeAnalysisModalButtonFromAnalysis = document.getElementById('closeAnalysisModalButtonFromAnalysis');
    elements.confirmAnalysisModalButtonFromAnalysis = document.getElementById('confirmAnalysisModalButtonFromAnalysis');
    elements.saveAnalysisButton = document.getElementById('saveAnalysisButton');

    elements.favoritesModal = document.getElementById('favoritesModal');
    elements.favoritesModalContent = document.getElementById('favoritesModalContent');
    elements.closeFavoritesModalButton = document.getElementById('closeFavoritesModalButton');
    elements.confirmFavoritesModalButton = document.getElementById('confirmFavoritesModalButton');
    elements.favoritesList = document.getElementById('favoritesList');
    
    elements.savedAnalysesModal = document.getElementById('savedAnalysesModal');
    elements.savedAnalysesModalContent = document.getElementById('savedAnalysesModalContent');
    elements.closeSavedAnalysesModalButton = document.getElementById('closeSavedAnalysesModalButton');
    elements.confirmSavedAnalysesModalButton = document.getElementById('confirmSavedAnalysesModalButton');
    elements.savedAnalysesList = document.getElementById('savedAnalysesList');

    elements.guideModalTitle = elements.guideModal ? elements.guideModal.querySelector('h2') : null;
    elements.analysisModalTitle = elements.analysisModal ? elements.analysisModal.querySelector('h3') : null;
    elements.englishFeedbackTitle = elements.analysisModal ? elements.analysisModal.querySelector('#englishAnalysisResult h4') : null;
    elements.koreanSummaryTitle = elements.analysisModal ? elements.analysisModal.querySelector('#koreanAnalysisResult h4') : null;
    elements.favoritesModalTitle = elements.favoritesModal ? elements.favoritesModal.querySelector('h3') : null;

    elements.guideP1 = elements.guideModalContent ? elements.guideModalContent.querySelector('div.space-y-3 p:nth-of-type(1)') : null;
    elements.guideP2 = elements.guideModalContent ? elements.guideModalContent.querySelector('div.space-y-3 p:nth-of-type(2)') : null;
    elements.guideP3 = elements.guideModalContent ? elements.guideModalContent.querySelector('div.space-y-3 p:nth-of-type(3)') : null;
    elements.guideP4_header = elements.guideModalContent ? elements.guideModalContent.querySelector('div.space-y-3 p:nth-of-type(4) strong') : null;
    elements.guideUl = elements.guideModalContent ? elements.guideModalContent.querySelector('ul') : null;
    elements.guideUl_item1_li = elements.guideUl ? elements.guideUl.querySelector('li:nth-of-type(1)') : null;
    elements.guideUl_item2_li = elements.guideUl ? elements.guideUl.querySelector('li:nth-of-type(2)') : null;
    elements.guideUl_item3_li = elements.guideUl ? elements.guideUl.querySelector('li:nth-of-type(3)') : null;
    elements.guideP5 = elements.guideModalContent ? elements.guideModalContent.querySelector('div.space-y-3 p:nth-of-type(5)') : null;
    
    console.log("initDOMElements: DOM ìš”ì†Œ ìºì‹± ì™„ë£Œ", elements);
}

// --- ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ---

function simpleMarkdownToHtml(text) {
    if (!text) return '';
    let html = text;
    html = html.replace(/\*\*(.*?)\*\*|__(.*?)__/g, '<strong>$1$2</strong>');
    html = html.replace(/\*(.*?)\*|_(.*?)_/g, '<em>$1$2</em>');
    html = html.replace(/~~(.*?)~~/g, '<del>$1</del>');
    html = html.replace(/^\s*[\*\-\+]\s+(.*)/gm, '<li>$1</li>');
    html = html.replace(/(<li>.*?<\/li>)+/gs, '<ul>$&</ul>');
    html = html.replace(/\n/g, '<br />');
    html = html.replace(/<li><br \/>/g, '<li>');
    html = html.replace(/<br \/><\/li>/g, '</li>');
    html = html.replace(/<br \/>\s*<ul>/g, '<ul>');
    html = html.replace(/<\/ul>\s*<br \/>/g, '</ul>');
    return html;
}

function findScenarioById(id) {
    for (const category of appState.SCENARIO_DATA) {
        const found = category.items.find(item => item.id === id);
        if (found) return { ...found, categoryTitle: category.category };
    }
    return null;
}

function getStarterPhrases(scenario, userIsPlayingPrimaryRole) {
    return userIsPlayingPrimaryRole ? (scenario.starters_userAsPrimary || scenario.starters) : scenario.starters_userAsOther;
}

function getDynamicContext(scenario, customInput, focusTopic, userIsPlayingPrimaryRole) {
    if (!scenario) return "You are a general English tutor. No specific scenario is selected.";

    let scenarioSpecificContext = "";
    if (scenario.id === "custom") {
        if (!customInput.trim()) return `You are a helpful and friendly AI tutor. The user hasn't specified a custom scenario yet. Ask them what they'd like to practice. Keep your response brief (1-2 sentences) and ask only one question at a time.`;
        if (!userIsPlayingPrimaryRole) {
            scenarioSpecificContext = `ROLE SWAP: You are now the conversation partner in the user's custom scenario: "${customInput}". The human user is acting as your AI tutor or guide. Respond naturally based on the scenario, keep your response brief (1-2 sentences), and ask only one question at a time if needed. Don't ask questions that have already been answered.`;
        } else {
            scenarioSpecificContext = `You are a helpful and friendly AI tutor. The user wants to practice a conversation in their custom scenario: "${customInput}". Act as their conversation partner for this topic, ask relevant questions, and help them practice their English. Keep your response brief (1-2 sentences) and ask only one question at a time if needed. Don't ask questions that have already been answered.`;
        }
    } else {
        if (userIsPlayingPrimaryRole) {
            scenarioSpecificContext = scenario.baseContext;
        } else {
            scenarioSpecificContext = scenario.baseContext_swapped || `Role swap! You are now playing the role that the AI normally plays in the "${scenario.title}" scenario. For example, if the user was the customer in a cafe, you are now the customer. The human user is playing the opposite role (e.g., the barista). Start or respond accordingly, keep your response brief (1-2 sentences), and ask only one question at a time if needed. Don't ask questions that have already been answered.`;
        }
    }

    const focusTopicInstruction = (userIsPlayingPrimaryRole && focusTopic && scenario.id !== "custom") ? `\n\nThe user wants to focus on: "${focusTopic}". Try to incorporate this into the conversation.` : '';

    return `${scenarioSpecificContext}${focusTopicInstruction}`;
}

function saveConversationToLocal(dataStr) {
    try {
        const toSave = dataStr || JSON.stringify({
            messages: appState.currentMessages,
            scenarioId: appState.currentScenario?.id,
            customScenarioInput: appState.currentCustomScenarioInput,
            focusTopic: appState.currentFocusTopic,
            userIsPlayingPrimaryRole: appState.userIsPlayingPrimaryRole,
            savedAnalyses: appState.savedAnalyses
        });
        localStorage.setItem('savedConversation', toSave);
    } catch (e) { console.error('Failed to save conversation', e); }
}

function exportConversationToJson(returnString = false) {
    const data = {
        messages: appState.currentMessages,
        scenarioId: appState.currentScenario?.id,
        customScenarioInput: appState.currentCustomScenarioInput,
        focusTopic: appState.currentFocusTopic,
        userIsPlayingPrimaryRole: appState.userIsPlayingPrimaryRole
    };
    const jsonStr = JSON.stringify(data, null, 2);
    saveConversationToLocal(jsonStr);
    if (returnString) return jsonStr;
    const blob = new Blob([jsonStr], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'conversation.json';
    a.click();
    URL.revokeObjectURL(url);
}

function applyConversationData(data) {
    if (Array.isArray(data.messages)) {
        appState.currentMessages = data.messages.map(m => ({ ...m, favorite: m.favorite ?? false }));

    }
    if (data.scenarioId) {
        const scenario = findScenarioById(data.scenarioId);
        if (scenario) appState.currentScenario = scenario;
    }
    appState.currentCustomScenarioInput = data.customScenarioInput || '';
    appState.currentFocusTopic = data.focusTopic || '';
    if (typeof data.userIsPlayingPrimaryRole === 'boolean') {
        appState.userIsPlayingPrimaryRole = data.userIsPlayingPrimaryRole;
    }
    if (Array.isArray(data.savedAnalyses)) {
        appState.savedAnalyses = data.savedAnalyses;
    }
    renderMessages();
    updateScenarioDisplay(false);
}

function importConversationFromJson(file) {
    return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => {
            try {
                const data = JSON.parse(reader.result);
                applyConversationData(data);
                saveConversationToLocal(JSON.stringify(data));
                resolve();
            } catch (e) {
                alert('Invalid JSON');
                reject(e);
            }
        };
        reader.onerror = reject;
        reader.readAsText(file);
    });
}

function restoreConversationFromLocal() {
    const saved = localStorage.getItem('savedConversation');
    if (!saved) return;
    try {
        const data = JSON.parse(saved);
        applyConversationData(data);
    } catch (e) { console.error('Failed to restore', e); }
}

// --- UI ë Œë”ë§ ë° ì¡°ì‘ í•¨ìˆ˜ ---

function renderMessages() {
    if (!elements.messagesContainer) return;
    elements.messagesContainer.innerHTML = '';
    appState.currentMessages.forEach((msg, idx) => {
        const messageWrapper = document.createElement('div');
        messageWrapper.className = `flex ${msg.sender === 'user' ? 'justify-end' : 'justify-start'}`;
        const messageBubble = document.createElement('div');
        messageBubble.className = `max-w-3/4 sm:max-w-md lg:max-w-lg px-3 py-2 sm:px-4 sm:py-2.5 rounded-2xl shadow ${
            msg.sender === 'user' ? 'user-bubble text-white rounded-br-none' : 'ai-bubble text-slate-800 rounded-bl-none'
        }`;
        messageBubble.innerHTML = simpleMarkdownToHtml(msg.text);
        messageWrapper.appendChild(messageBubble);
        const favButton = document.createElement('button');
        favButton.className = 'favorite-btn ml-1';
        favButton.textContent = msg.favorite ? 'â˜…' : 'â˜†';
        favButton.title = appState.UI_TEXT?.favoriteButtonTitle || 'Favorite';
        favButton.dataset.index = idx;

        messageWrapper.appendChild(favButton);
        elements.messagesContainer.appendChild(messageWrapper);
    });
    elements.messagesContainer.scrollTop = elements.messagesContainer.scrollHeight;
}

function updateScenarioDisplay(isConversationStarting = false) {
    if (!appState.currentScenario) return;

    const displayTitle = appState.currentScenario.id === 'custom'
        ? (appState.currentCustomScenarioInput ? `${appState.UI_TEXT.scenarioTitleCustom(appState.currentCustomScenarioInput).split(':')[0]}: ${appState.currentCustomScenarioInput.substring(0, 10)}...` : appState.UI_TEXT.scenarioTitleCustom(appState.currentCustomScenarioInput))
        : (appState.currentScenario.categoryTitle ? `${appState.currentScenario.title.split(" ")[0]}` : appState.currentScenario.title.split(" ")[0]);

    if (elements.currentScenarioDisplay) elements.currentScenarioDisplay.textContent = "ì‹œë‚˜ë¦¬ì˜¤";
    if (elements.headerTitle) elements.headerTitle.title = appState.currentScenario.title;

    const elementsToHide = document.querySelectorAll('.hide-after-conversation-start');
    if (isConversationStarting) {
        elementsToHide.forEach(el => el.classList.add('hidden'));
        if (elements.scenarioDescriptionArea) {
            elements.scenarioDescriptionArea.classList.remove('pb-4', 'sm:pb-5');
        }
        if (elements.scenarioTitleElem) {
            elements.scenarioTitleElem.classList.remove('mb-1.5');
            elements.scenarioTitleElem.classList.add('mb-0');
        }
    } else {
        elementsToHide.forEach(el => el.classList.remove('hidden'));
        if (elements.scenarioTitleElem) {
            elements.scenarioTitleElem.textContent = appState.currentScenario.id === "custom"
                ? appState.UI_TEXT.scenarioTitleCustom(appState.currentCustomScenarioInput)
                : appState.currentScenario.title;
        }
        if (elements.scenarioDescriptionElem) {
            elements.scenarioDescriptionElem.textContent = appState.currentScenario.id === "custom"
                ? appState.UI_TEXT.customScenarioDescription
                : appState.currentScenario.description;
        }

        if (elements.starterPhrasesContainer) {
            elements.starterPhrasesContainer.innerHTML = '';
        }

        const starters = getStarterPhrases(appState.currentScenario, appState.userIsPlayingPrimaryRole);
        if (starters && starters.length > 0) {
            if (elements.starterPhrasesContainer) {
                elements.starterPhrasesContainer.classList.remove('hidden');

                const starterPrefix = document.createElement('p');
                starterPrefix.className = "text-xs font-semibold text-sky-600 mb-1.5";
                starterPrefix.textContent = appState.UI_TEXT.starterPhrasePrefix;
                elements.starterPhrasesContainer.appendChild(starterPrefix);

                const newStarterPhrasesDiv = document.createElement('div');
                newStarterPhrasesDiv.id = 'starterPhrases';
                newStarterPhrasesDiv.className = 'flex flex-wrap gap-2';
                elements.starterPhrasesContainer.appendChild(newStarterPhrasesDiv);

                starters.forEach(starter => {
                    const button = document.createElement('button');
                    button.className = "text-xs bg-sky-100 hover:bg-sky-200 text-sky-700 px-2 py-1 rounded-md shadow-sm transition-colors";
                    button.textContent = `"${starter}"`;
                    button.onclick = () => { if (elements.userInputElem) elements.userInputElem.value = starter; };
                    newStarterPhrasesDiv.appendChild(button);
                });
            }
        } else {
            if (elements.starterPhrasesContainer) {
                elements.starterPhrasesContainer.classList.add('hidden');
            }
        }

        if (appState.currentScenario.id === "custom") {
            if (elements.customScenarioGroup) elements.customScenarioGroup.classList.remove('hidden');
            if (elements.focusTopicGroup) elements.focusTopicGroup.classList.add('hidden');
            if (elements.customScenarioInputElem) {
                elements.customScenarioInputElem.value = appState.currentCustomScenarioInput;
                elements.customScenarioInputElem.placeholder = appState.UI_TEXT.customScenarioPlaceholder;
            }
        } else {
            if (elements.customScenarioGroup) elements.customScenarioGroup.classList.add('hidden');
            if (elements.focusTopicGroup) elements.focusTopicGroup.classList.remove('hidden');
            if (elements.focusTopicInput) {
                elements.focusTopicInput.value = appState.currentFocusTopic;
                elements.focusTopicInput.placeholder = appState.UI_TEXT.focusTopicPlaceholder;
            }
        }

        if (elements.scenarioDescriptionArea) {
            elements.scenarioDescriptionArea.classList.remove('hidden');
            elements.scenarioDescriptionArea.classList.add('pb-4', 'sm:pb-5');
        }
        if (elements.scenarioTitleElem) {
            elements.scenarioTitleElem.classList.add('mb-1.5');
            elements.scenarioTitleElem.classList.remove('mb-0');
        }
    }
}

function updateAllButtonTexts() {
    if (elements.headerTitle) elements.headerTitle.textContent = appState.UI_TEXT.appTitle;
    if (elements.helpButton) elements.helpButton.title = appState.UI_TEXT.guideModalTitle.split(' ')[0];
    if (elements.viewFavoritesButton) elements.viewFavoritesButton.title = appState.UI_TEXT.viewFavoritesButtonTitle;
    if (elements.newConversationButton) elements.newConversationButton.title = appState.UI_TEXT.newConversationAlert("").split(" ")[0];

    if (elements.suggestRepliesButtonText) elements.suggestRepliesButtonText.textContent = appState.UI_TEXT.suggestReplies;
    if (elements.analyzeSentenceButtonText) elements.analyzeSentenceButtonText.textContent = appState.UI_TEXT.analyzeSentence;
    if (elements.roleSwapButtonText) elements.roleSwapButtonText.textContent = appState.UI_TEXT.roleSwapButtonText;
    if (elements.userInputElem) elements.userInputElem.placeholder = appState.UI_TEXT.customScenarioPlaceholder;

    if (elements.guideModalTitle) elements.guideModalTitle.textContent = appState.UI_TEXT.guideModalTitle;
    if (elements.guideP1) elements.guideP1.innerHTML = appState.UI_TEXT.guideP1_html;
    if (elements.guideP2) elements.guideP2.innerHTML = appState.UI_TEXT.guideP2_html;
    if (elements.guideP3) elements.guideP3.innerHTML = appState.UI_TEXT.guideP3_html;

    if (elements.guideP4_header) elements.guideP4_header.innerHTML = appState.UI_TEXT.guideP4_header_html;
    if (elements.guideUl_item1_li) elements.guideUl_item1_li.innerHTML = appState.UI_TEXT.guideP4_item1_html;
    if (elements.guideUl_item2_li) elements.guideUl_item2_li.innerHTML = appState.UI_TEXT.guideP4_item2_html;
    if (elements.guideUl_item3_li) elements.guideUl_item3_li.innerHTML = appState.UI_TEXT.guideP4_item3_html;

    if (elements.guideP5) elements.guideP5.innerHTML = appState.UI_TEXT.guideP5_html;
    if (elements.confirmGuideModalButton) elements.confirmGuideModalButton.textContent = appState.UI_TEXT.guideModalConfirmButton;

    if (elements.analysisModalTitle) elements.analysisModalTitle.textContent = appState.UI_TEXT.analysisResultTitle;
    if (elements.englishFeedbackTitle) elements.englishFeedbackTitle.textContent = appState.UI_TEXT.englishFeedbackTitle;
    if (elements.koreanSummaryTitle) elements.koreanSummaryTitle.textContent = appState.UI_TEXT.koreanSummaryTitle;
    if (elements.confirmAnalysisModalButtonFromAnalysis) elements.confirmAnalysisModalButtonFromAnalysis.textContent = appState.UI_TEXT.analysisConfirmButton;
    if (elements.favoritesModalTitle) elements.favoritesModalTitle.textContent = appState.UI_TEXT.favoritesModalTitle;
    if (elements.confirmFavoritesModalButton) elements.confirmFavoritesModalButton.textContent = appState.UI_TEXT.analysisConfirmButton;

    const langLinks = elements.languageDropdown ? elements.languageDropdown.querySelectorAll('a') : [];
    langLinks.forEach(link => {
        const langCode = link.dataset.lang;
        if (langPacks[langCode]) {
            link.textContent = langPacks[langCode].displayName;
        }
    });

    if (elements.currentLanguageDisplay && langPacks[appState.currentLangCode]) {
        elements.currentLanguageDisplay.textContent = langPacks[appState.currentLangCode].displayName;
    }
}

function setLoadingState(buttonId, textWhileLoading, isLoadingFlag) {
    const button = elements[buttonId];
    const buttonTextSpan = elements[`${buttonId}Text`];
    if (button && buttonTextSpan) {
        button.disabled = isLoadingFlag;
        buttonTextSpan.textContent = isLoadingFlag ? textWhileLoading : (buttonId === 'suggestRepliesButton' ? appState.UI_TEXT.suggestReplies : appState.UI_TEXT.analyzeSentence);
    }
}

function setSendMessageLoadingState(isLoadingFlag) {
    if (!elements.sendMessageButton) return;
    elements.sendMessageButton.disabled = isLoadingFlag;
    if (isLoadingFlag) {
        elements.sendMessageButton.innerHTML = `<svg class="animate-spin h-6 w-6 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"> <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle> <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path> </svg>`;
    } else {
        elements.sendMessageButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-6 h-6"> <path d="M3.5 2.75a.75.75 0 00-1.061.645l1.906 11.438a.75.75 0 001.412-.001L7.25 9.086l5.438-4.078a.75.75 0 00-.816-1.299L4.06 7.354 3.5 2.75zM2.75 16.5a.75.75 0 001.061.645l12.626-7.575a.75.75 0 000-1.29l-12.626-7.575A.75.75 0 002.75 1.5v15z" /> </svg>`;
    }
}

function clearInput(elementId) {
    if (elements[elementId]) {
        elements[elementId].value = '';
    }
}

function hideSuggestedReplies() {
    if (elements.suggestedRepliesList) elements.suggestedRepliesList.innerHTML = '';
    if (elements.suggestedRepliesContainer) elements.suggestedRepliesContainer.classList.add('hidden');
}

function renderScenarioPicker() {
    if (!elements.scenarioDropdown) return;
    elements.scenarioDropdown.innerHTML = '';
    appState.SCENARIO_DATA.forEach(category => {
        const categoryDiv = document.createElement('div');
        const categoryHeader = document.createElement('div');
        categoryHeader.className = `flex justify-between items-center p-1.5 sm:p-2 hover:bg-sky-100 cursor-pointer text-slate-800 font-medium text-xs sm:text-sm category-header`;
        if (category.isCustomCategory && appState.currentScenario && appState.currentScenario.id === category.items[0].id) {
            categoryHeader.classList.add('scenario-picker-item-selected');
        }

        const categoryTitleSpan = document.createElement('span');
        categoryTitleSpan.textContent = category.category;
        categoryHeader.appendChild(categoryTitleSpan);

        if (!category.isCustomCategory) {
            const chevron = document.createElement('span');
            const svgNS = "http://www.w3.org/2000/svg";
            const svgEl = document.createElementNS(svgNS, "svg");
            svgEl.setAttribute("viewBox", "0 0 20 20");
            svgEl.setAttribute("fill", "currentColor");
            svgEl.classList.add("w-5", "h-5", "transform", "transition-transform");
            if (appState.expandedCategories[category.category]) {
                svgEl.classList.add("rotate-90");
            } else {
                svgEl.classList.remove("rotate-90");
            }
            const pathEl = document.createElementNS(svgNS, "path");
            pathEl.setAttribute("fill-rule", "evenodd");
            pathEl.setAttribute("d", "M7.21 14.77a.75.75 0 0 1 .02-1.06L11.168 10 7.23 6.29a.75.75 0 1 1 1.04-1.08l4.5 4.25a.75.75 0 0 1 0 1.08l-4.5 4.25a.75.75 0 0 1-1.06-.02Z");
            pathEl.setAttribute("clip-rule", "evenodd");
            svgEl.appendChild(pathEl);
            chevron.appendChild(svgEl);
            categoryHeader.appendChild(chevron);
        }

        categoryHeader.onclick = (event) => {
            event.stopPropagation();
            console.log("ì¹´í…Œê³ ë¦¬ í—¤ë” í´ë¦­:", category.category);
            if (category.isCustomCategory) {
                handleScenarioSelect(category.items[0]);
            } else {
                appState.expandedCategories[category.category] = !appState.expandedCategories[category.category];
                renderScenarioPicker();
            }
        };
        categoryDiv.appendChild(categoryHeader);

        if (appState.expandedCategories[category.category] && !category.isCustomCategory) {
            const itemsDiv = document.createElement('div');
            itemsDiv.className = "pl-3 border-l border-sky-200";
            category.items.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = `py-1 px-1.5 sm:py-1.5 sm:px-2 text-xs hover:bg-sky-50 cursor-pointer text-slate-600 scenario-picker-item`;
                if (appState.currentScenario && appState.currentScenario.id === item.id) {
                    itemDiv.classList.add('scenario-picker-item-selected');
                }
                itemDiv.textContent = item.title;
                itemDiv.onclick = (event) => {
                    event.stopPropagation();
                    console.log("ì‹œë‚˜ë¦¬ì˜¤ ì•„ì´í…œ í´ë¦­:", item.title);
                    handleScenarioSelect(item);
                };
                itemsDiv.appendChild(itemDiv);
            });
            categoryDiv.appendChild(itemsDiv);
        }
        elements.scenarioDropdown.appendChild(categoryDiv);
    });
}

function toggleScenarioPicker() {
    console.log("toggleScenarioPicker í˜¸ì¶œë¨");
    appState.showScenarioPicker = !appState.showScenarioPicker;
    if (appState.showScenarioPicker) {
        renderScenarioPicker();
        if (elements.scenarioDropdown) {
            elements.scenarioDropdown.classList.remove('hidden');
            elements.scenarioDropdown.classList.add('fade-in');
        }
        if (appState.showLanguagePicker) {
            toggleLanguagePicker();
        }
    } else {
        if (elements.scenarioDropdown) {
            elements.scenarioDropdown.classList.add('hidden');
        }
        appState.expandedCategories = {};
    }
}

function toggleLanguagePicker() {
    console.log("toggleLanguagePicker í˜¸ì¶œë¨");
    appState.showLanguagePicker = !appState.showLanguagePicker;
    if (appState.showLanguagePicker) {
        if (elements.languageDropdown) {
            elements.languageDropdown.classList.remove('hidden');
            elements.languageDropdown.classList.add('fade-in');
        }
        if (appState.showScenarioPicker) {
            toggleScenarioPicker();
        }
        if (appState.showJsonMenu) {
            toggleJsonMenu();
        }
    } else {
        if (elements.languageDropdown) {
            elements.languageDropdown.classList.add('hidden');
        }
    }
}

function toggleJsonMenu() {
    appState.showJsonMenu = !appState.showJsonMenu;
    if (appState.showJsonMenu) {
        if (elements.jsonMenuDropdown) {
            elements.jsonMenuDropdown.classList.remove('hidden');
            elements.jsonMenuDropdown.classList.add('fade-in');
        }
        if (appState.showScenarioPicker) toggleScenarioPicker();
        if (appState.showLanguagePicker) toggleLanguagePicker();
        if (appState.showSavedDataMenu) toggleSavedDataMenu();
    } else {
        if (elements.jsonMenuDropdown) {
            elements.jsonMenuDropdown.classList.add('hidden');
        }
    }
}

function toggleSavedDataMenu() {
    appState.showSavedDataMenu = !appState.showSavedDataMenu;
    if (appState.showSavedDataMenu) {
        if (elements.savedDataMenuDropdown) {
            elements.savedDataMenuDropdown.classList.remove('hidden');
            elements.savedDataMenuDropdown.classList.add('fade-in');
        }
        if (appState.showScenarioPicker) toggleScenarioPicker();
        if (appState.showLanguagePicker) toggleLanguagePicker();
        if (appState.showJsonMenu) toggleJsonMenu();
    } else {
        if (elements.savedDataMenuDropdown) {
            elements.savedDataMenuDropdown.classList.add('hidden');
        }
    }
}


// --- ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜ ---

function showGuideModal() {
    console.log("showGuideModal í˜¸ì¶œë¨");
    if (!elements.guideModal) return;
    elements.guideModal.classList.remove('hidden');
    elements.guideModal.classList.add('fade-in');
}

function closeGuideModal() {
    console.log("closeGuideModal í˜¸ì¶œë¨");
    if (!elements.guideModal) return;
    elements.guideModal.classList.add('hidden');
    localStorage.setItem(`guideShown_${APP_ID}`, 'true');
}

function showAnalysisModal(combinedAnalysisText, userMessage = "", scenario = "") {
    const koreanSummaryMarker = appState.UI_TEXT.koreanSummaryTitle;
    const koreanSummaryIndex = combinedAnalysisText.indexOf(koreanSummaryMarker);

    let engAnalysis = "";
    let korSummary = "";

    if (koreanSummaryIndex !== -1) {
        engAnalysis = combinedAnalysisText.substring(0, koreanSummaryIndex).trim();
        korSummary = combinedAnalysisText.substring(koreanSummaryIndex + koreanSummaryMarker.length).trim();
    } else {
        engAnalysis = combinedAnalysisText.trim();
        korSummary = "í•œêµ­ì–´ ìš”ì•½ì„ ìƒì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
    }

    const engDiv = document.querySelector('#englishAnalysisResult div');
    const korDiv = document.querySelector('#koreanAnalysisResult div');
    const modal = document.getElementById('analysisModal');

    if (engDiv) engDiv.innerHTML = simpleMarkdownToHtml(engAnalysis);
    if (korDiv) korDiv.innerHTML = simpleMarkdownToHtml(korSummary);

    if (modal) {
        modal.classList.remove('hidden');
        modal.classList.add('fade-in');
    }
}

function closeAnalysisModal() {
    console.log("closeAnalysisModal í˜¸ì¶œë¨");
    if (elements.analysisModal) elements.analysisModal.classList.add('hidden');
    if (elements.englishAnalysisResultDiv) elements.englishAnalysisResultDiv.innerHTML = '';
    if (elements.koreanAnalysisResultDiv) elements.koreanAnalysisResultDiv.innerHTML = '';
}

function toggleFavorite(index) {
    const msg = appState.currentMessages[index];
    if (!msg) return;
    msg.favorite = !msg.favorite;
    renderMessages();
    saveConversationToLocal();
}
function showFavoritesModal() {
    console.log("ì¦ê²¨ì°¾ê¸° ëª¨ë‹¬ ì—´ê¸° ì‹œë„");
    
    // ì¦‰ì‹œ DOMì—ì„œ ì§ì ‘ ê°€ì ¸ì˜¤ê¸°
    const modal = document.getElementById('favoritesModal');
    const list = document.getElementById('favoritesList');
    
    if (!modal) {
        alert("ì¦ê²¨ì°¾ê¸° ëª¨ë‹¬ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        return;
    }
    
    if (!list) {
        alert("ì¦ê²¨ì°¾ê¸° ëª©ë¡ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        return;
    }

    // ì¦ê²¨ì°¾ê¸°ëœ ë©”ì‹œì§€ í•„í„°ë§
    const favoriteMessages = appState.currentMessages.filter(msg => msg.favorite === true);
    console.log("ì¦ê²¨ì°¾ê¸° ë©”ì‹œì§€ ê°œìˆ˜:", favoriteMessages.length);

    // ëª©ë¡ ì´ˆê¸°í™” ë° ì±„ìš°ê¸°
    list.innerHTML = '';
    
    if (favoriteMessages.length === 0) {
        list.innerHTML = '<p class="text-center text-gray-500 py-4">ì¦ê²¨ì°¾ê¸°í•œ ë¬¸ì¥ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
    } else {
        favoriteMessages.forEach((msg, index) => {
            const div = document.createElement('div');
            div.className = 'p-3 bg-slate-50 rounded-lg border border-slate-200 mb-2';
            div.innerHTML = `
                <div class="flex justify-between items-start">
                    <p class="text-sm text-slate-700">${msg.text}</p>
                    <button onclick="removeFavorite(${appState.currentMessages.indexOf(msg)})" class="text-red-500 hover:text-red-700 ml-2">Ã—</button>
                </div>
            `;
            list.appendChild(div);
        });
    }

    // ëª¨ë‹¬ í‘œì‹œ
    modal.classList.remove('hidden');
    modal.classList.add('fade-in');
    console.log("ì¦ê²¨ì°¾ê¸° ëª¨ë‹¬ í‘œì‹œë¨");
}

function closeFavoritesModal() {
    const modal = document.getElementById('favoritesModal');
    if (modal) {
        modal.classList.add('hidden');
    }
}

function removeFavorite(messageIndex) {
    if (appState.currentMessages[messageIndex]) {
        appState.currentMessages[messageIndex].favorite = false;
        renderMessages();
        saveConversationToLocal();
        showFavoritesModal(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
    }
}

let currentAnalysisData = null;

function saveCurrentAnalysis() {
    console.log("ë¶„ì„ ì €ì¥ ì‹œë„");
    
    // í˜„ì¬ ë¶„ì„ ëª¨ë‹¬ì—ì„œ ë°ì´í„° ì§ì ‘ ê°€ì ¸ì˜¤ê¸°
    const engDiv = document.querySelector('#englishAnalysisResult div');
    const korDiv = document.querySelector('#koreanAnalysisResult div');
    
    if (!engDiv || !korDiv || !engDiv.innerHTML.trim() || !korDiv.innerHTML.trim()) {
        alert("ì €ì¥í•  ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ë¬¸ì¥ ë¶„ì„ì„ ì‹¤í–‰í•´ì£¼ì„¸ìš”.");
        return;
    }
    
    // ë¶„ì„í•œ ë§ˆì§€ë§‰ ì‚¬ìš©ì ë©”ì‹œì§€ ì°¾ê¸°
    const userMessages = appState.currentMessages.filter(msg => msg.sender === 'user');
    if (userMessages.length === 0) {
        alert("ë¶„ì„í•  ì‚¬ìš©ì ë©”ì‹œì§€ê°€ ì—†ìŠµë‹ˆë‹¤.");
        return;
    }
    
    const lastUserMessage = userMessages[userMessages.length - 1];
    const currentScenario = appState.currentScenario ? appState.currentScenario.title : "ì•Œ ìˆ˜ ì—†ìŒ";
    
    const analysisItem = {
        id: Date.now(),
        timestamp: new Date().toISOString(),
        userMessage: lastUserMessage.text,
        scenario: currentScenario,
        engAnalysis: engDiv.innerHTML,
        korSummary: korDiv.innerHTML
    };
    
    // savedAnalyses ë°°ì—´ì´ ì—†ìœ¼ë©´ ì´ˆê¸°í™”
    if (!appState.savedAnalyses) {
        appState.savedAnalyses = [];
    }
    
    appState.savedAnalyses.push(analysisItem);
    saveConversationToLocal();
    
    alert("ë¶„ì„ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!");
    console.log("ë¶„ì„ ì €ì¥ ì™„ë£Œ, ì´ ì €ì¥ëœ ë¶„ì„:", appState.savedAnalyses.length);
}

function showSavedAnalysesModal() {
    console.log("ì €ì¥ëœ ë¶„ì„ ëª¨ë‹¬ ì—´ê¸°");
    
    const modal = document.getElementById('savedAnalysesModal');
    const list = document.getElementById('savedAnalysesList');
    
    if (!modal) {
        alert("ì €ì¥ëœ ë¶„ì„ ëª¨ë‹¬ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        return;
    }
    
    if (!list) {
        alert("ì €ì¥ëœ ë¶„ì„ ëª©ë¡ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        return;
    }

    // savedAnalyses ë°°ì—´ì´ ì—†ìœ¼ë©´ ì´ˆê¸°í™”
    if (!appState.savedAnalyses) {
        appState.savedAnalyses = [];
    }

    console.log("ì €ì¥ëœ ë¶„ì„ ê°œìˆ˜:", appState.savedAnalyses.length);
    
    list.innerHTML = '';
    
    if (appState.savedAnalyses.length === 0) {
        list.innerHTML = '<p class="text-center text-gray-500 py-4">ì €ì¥ëœ ë¶„ì„ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
    } else {
        appState.savedAnalyses.forEach((analysis, index) => {
            const div = document.createElement('div');
            div.className = 'p-4 bg-slate-50 rounded-lg border border-slate-200 mb-4';
            
            const timestamp = new Date(analysis.timestamp).toLocaleString('ko-KR');
            
            div.innerHTML = `
                <div class="flex justify-between items-start mb-3">
                    <div class="text-sm text-slate-500">
                        <span class="font-medium">${timestamp}</span> | ${analysis.scenario}
                    </div>
                    <button onclick="deleteSavedAnalysis(${index})" class="text-red-500 hover:text-red-700 text-sm font-medium">ì‚­ì œ</button>
                </div>
                <div class="mb-3">
                    <div class="text-sm font-medium text-sky-700 mb-1">ğŸ“ ë¶„ì„í•œ ë¬¸ì¥:</div>
                    <div class="text-sm bg-white p-2 rounded border">${analysis.userMessage}</div>
                </div>
                <div class="mb-3">
                    <div class="text-sm font-medium text-slate-800 mb-1">ğŸ“ ì˜ì–´ í”¼ë“œë°±:</div>
                    <div class="text-sm text-slate-700 bg-white p-2 rounded border" style="white-space: pre-wrap;">${analysis.engAnalysis}</div>
                </div>
                <div>
                    <div class="text-sm font-medium text-slate-800 mb-1">ğŸ‡°ğŸ‡· í•œêµ­ì–´ ìš”ì•½:</div>
                    <div class="text-sm text-slate-700 bg-sky-50 p-2 rounded border border-sky-200" style="white-space: pre-wrap;">${analysis.korSummary}</div>
                </div>
            `;
            
            list.appendChild(div);
        });
    }

    modal.classList.remove('hidden');
    modal.classList.add('fade-in');
    console.log("ì €ì¥ëœ ë¶„ì„ ëª¨ë‹¬ í‘œì‹œë¨");
}

function closeSavedAnalysesModal() {
    const modal = document.getElementById('savedAnalysesModal');
    if (modal) {
        modal.classList.add('hidden');
    }
}

function deleteSavedAnalysis(index) {
    if (confirm("ì´ ë¶„ì„ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
        if (!appState.savedAnalyses) {
            appState.savedAnalyses = [];
        }
        appState.savedAnalyses.splice(index, 1);
        saveConversationToLocal();
        showSavedAnalysesModal(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
    }
}

// --- ì™¸ë¶€APIí†µì‹ í•¨ìˆ˜ ---

async function callGeminiAPI(prompt) {
    const payload = { message: prompt };
    try {
        const response = await fetch(API_ENDPOINT, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });

        if (!response.ok) {
            let errorDetails = `Server response: ${response.statusText || 'Unknown error'}`;
            try {
                const errorData = await response.json();
                errorDetails = errorData.error || errorData.message || (typeof errorData === 'object' ? JSON.stringify(errorData) : String(errorData));
                if (!errorDetails || errorDetails === '{}' || errorDetails.trim() === "") {
                    errorDetails = `Server response: ${response.statusText || 'No error details'}`;
                }
            } catch (jsonError) {
                console.warn("API error response is not JSON, trying to read as text.", jsonError);
                try {
                    const errorText = await response.text();
                    errorDetails = errorText.trim() || `Server response: ${response.statusText || 'No error details'}`;
                } catch (textError) {
                    console.error("Failed to read API error response as text.", textError);
                    errorDetails = `Server response: ${response.statusText || 'Unknown error'}, failed to read response body`;
                }
            }
            const errorMsg = `API request failed (${response.status}): ${errorDetails}`;
            console.error("API Error Details:", errorDetails);
            throw new Error(errorMsg);
        }

        const result = await response.json();
        if (result.text) {
            return result.text;
        } else if (result.generated_text) {
            return result.generated_text;
        } else if (result.reply) {
            return result.reply;
        } else if (typeof result === 'string') {
            return result;
        } else if (result.candidates && result.candidates[0]?.content?.parts[0]?.text) {
            console.warn("Received Gemini API format response. Make sure the Glitch endpoint supports this format.");
            return result.candidates[0].content?.parts[0]?.text || '';
        } else {
            console.error("Cannot extract text from API response or unexpected structure:", result);
            throw new Error('No valid text response received from AI.');
        }
    } catch (error) {
        console.error("Exception during API call:", error);
        throw error;
    }
}

// --- ì´ë²¤íŠ¸í•¸ë“¤ëŸ¬í•¨ìˆ˜ ---

async function handleSendMessage() {
    console.log("handleSendMessage í˜¸ì¶œë¨");
    if (!elements.userInputElem || elements.userInputElem.value.trim() === '' || appState.isLoading) return;

    if (appState.currentScenario.id === "custom" && elements.customScenarioInputElem && elements.customScenarioInputElem.value.trim() === '' && appState.currentMessages.length === 0) {
        alert(appState.UI_TEXT.customScenarioInputRequired);
        return;
    }

    const newUserMessage = { sender: 'user', text: elements.userInputElem.value.trim(), timestamp: new Date(), favorite: false };
    appState.currentMessages.push(newUserMessage);
    renderMessages();
    saveConversationToLocal();
    const currentInputForAPI = elements.userInputElem.value;
    clearInput('userInputElem');

    appState.isLoading = true;
    setSendMessageLoadingState(true);

    hideSuggestedReplies();
    closeAnalysisModal();
    updateScenarioDisplay(true);

    const contextForAI = getDynamicContext(
        appState.currentScenario,
        appState.currentCustomScenarioInput,
        appState.currentFocusTopic,
        appState.userIsPlayingPrimaryRole
    );

    let conversationHistoryForAPI = "Previous conversation:\n";
    appState.currentMessages.slice(Math.max(0, appState.currentMessages.length - 7), -1).forEach(msg => {
        conversationHistoryForAPI += `${msg.sender === 'user' ? 'User' : 'AI'}: ${msg.text}\n`;
    });

    const promptForAI = `System Instruction: ${contextForAI}\n\n${appState.currentMessages.length > 1 ? conversationHistoryForAPI : ''}User: ${currentInputForAPI}`;

    try {
        const aiResponseText = await callGeminiAPI(promptForAI);
        const newAiMessage = { sender: 'ai', text: aiResponseText, timestamp: new Date(), favorite: false };
        appState.currentMessages.push(newAiMessage);
        renderMessages();
        saveConversationToLocal();
    } catch (error) {
        appState.currentMessages.push({ sender: 'ai', text: `${appState.UI_TEXT.aiResponseError} ${error.message}`, timestamp: new Date(), favorite: false });
        renderMessages();
        saveConversationToLocal();
    } finally {
        appState.isLoading = false;
        setSendMessageLoadingState(false);
    }
}

async function handleSuggestReplies() {
    console.log("handleSuggestReplies í˜¸ì¶œë¨");
    if (appState.isLoadingSuggestions || appState.currentMessages.length === 0) return;
    const lastMessage = appState.currentMessages[appState.currentMessages.length - 1];
    if (lastMessage.sender !== 'ai') {
        alert(appState.UI_TEXT.suggestionsAfterAiResponse);
        return;
    }

    appState.isLoadingSuggestions = true;
    setLoadingState('suggestRepliesButton', appState.UI_TEXT.loading, true);
    closeAnalysisModal();

    try {
        const scenarioTitleForPrompt = appState.currentScenario.id === "custom" ? (appState.currentCustomScenarioInput || appState.UI_TEXT.scenarioTitleCustom(appState.currentCustomScenarioInput)) : appState.currentScenario.title;
        const focusTopicForPrompt = appState.currentScenario.id === "custom" ? "" : (appState.currentFocusTopic ? `The user wants to focus on: "${appState.currentFocusTopic}".` : '');

        const prompt = `Based on the AI tutor's last message: "${lastMessage.text}", provide exactly 3 different, natural-sounding replies the user (an English learner) could say next (short to medium length) in the "${scenarioTitleForPrompt}" scenario. ${focusTopicForPrompt} Use strictly numbered list format, with each item starting with a number and period (e.g., 1. Suggestion 1). Do not include any introduction or explanation before or after the list. Consider the user's current role: ${appState.userIsPlayingPrimaryRole ? 'they are the primary actor in the scenario (e.g., customer, patient)' : 'they are playing the AI tutor/staff role'}`;
        const suggestionsText = await callGeminiAPI(prompt);

        let parsedSuggestions = suggestionsText.split('\n')
            .map(s => s.trim())
            .filter(s => s.length > 0 && /^\d+\.\s*.+/.test(s))
            .map(s => s.replace(/^\d+\.\s*/, '').trim())
            .filter(s => s.length > 0 && !s.toLowerCase().startsWith("here are") && !s.toLowerCase().includes("suggestion for"));

        if (elements.suggestedRepliesList) elements.suggestedRepliesList.innerHTML = '';
        if (parsedSuggestions.length > 0) {
            parsedSuggestions.slice(0,3).forEach(reply => {
                const li = document.createElement('li');
                li.className = "text-xs sm:text-sm text-sky-700 hover:text-sky-800 cursor-pointer p-1.5 bg-white rounded-md shadow-sm hover:shadow-md transition-shadow";
                li.textContent = `"${reply}"`;
                li.onclick = () => {
                    if (elements.userInputElem) elements.userInputElem.value = reply;
                    hideSuggestedReplies();
                };
                if (elements.suggestedRepliesList) elements.suggestedRepliesList.appendChild(li);
            });
            if (elements.suggestedRepliesContainer) {
                elements.suggestedRepliesContainer.classList.remove('hidden');
                elements.suggestedRepliesContainer.classList.add('fade-in');
            }
        } else {
            if (elements.suggestedRepliesList) {
                elements.suggestedRepliesList.innerHTML = `<li class="text-slate-500">${appState.UI_TEXT.errorMessageSuggestions}</li>`;
            }
            if (elements.suggestedRepliesContainer) {
                elements.suggestedRepliesContainer.classList.remove('hidden');
            }
        }
    } catch (error) {
        if (elements.suggestedRepliesList) {
            elements.suggestedRepliesList.innerHTML = `<li class="text-red-500">${appState.UI_TEXT.errorMessageSuggestions} ${error.message}</li>`;
        }
        if (elements.suggestedRepliesContainer) {
            elements.suggestedRepliesContainer.classList.remove('hidden');
        }
    } finally {
        appState.isLoadingSuggestions = false;
        setLoadingState('suggestRepliesButton', '', false);
    }
}

async function handleAnalyzeSentence() {
    console.log("handleAnalyzeSentence í˜¸ì¶œë¨");
    if (appState.isLoadingAnalysis) return;
    const userMessages = appState.currentMessages.filter(msg => msg.sender === 'user');
    if (userMessages.length === 0) {
        alert(appState.UI_TEXT.noUserMessageForAnalysis);
        return;
    }

    appState.isLoadingAnalysis = true;
    setLoadingState('analyzeSentenceButton', appState.UI_TEXT.loading, true);
    hideSuggestedReplies();
    closeAnalysisModal();

    try {
        const lastUserMessage = userMessages[userMessages.length - 1];
        const scenarioTitleForPrompt = appState.currentScenario.id === "custom" ? (appState.currentCustomScenarioInput || appState.UI_TEXT.scenarioTitleCustom(appState.currentCustomScenarioInput)) : appState.currentScenario.title;
        const focusTopicForPrompt = appState.currentScenario.id === "custom" ? "" : (appState.currentFocusTopic ? `The user wants to focus on: "${appState.currentFocusTopic}".` : '');

        const analysisPrompt = `The user (learning English) said: "${lastUserMessage.text}" in the context of "${scenarioTitleForPrompt}" scenario. ${focusTopicForPrompt} Provide a structured analysis in English: **â­ Overall Impression:** (Brief positive comment or general feel) **ğŸ‘ Strengths:** (What was good about the sentence) **ğŸ’¡ Areas for Improvement:** **Grammar:** (Specific errors & corrections. If none, say "Grammar is good.") **Vocabulary:** (Word choice suggestions, better alternatives. If good, say "Vocabulary is appropriate.") **Naturalness/Fluency:** (Tips to sound more natural. If good, say "Sounds natural.") **âœ¨ Suggested Revision (if any):** (Offer a revised version of the sentence if significant improvements can be made) Keep feedback constructive and easy for an English learner. After the English analysis, provide a concise summary of the feedback in Korean, under a heading "${appState.UI_TEXT.koreanSummaryTitle}". This summary should highlight the main points of the feedback for a beginner to understand easily.`;
        const combinedAnalysisText = await callGeminiAPI(analysisPrompt);
        showAnalysisModal(combinedAnalysisText, lastUserMessage.text, scenarioTitleForPrompt);
    } catch (error) {
        if (elements.englishAnalysisResultDiv) elements.englishAnalysisResultDiv.textContent = `${appState.UI_TEXT.errorMessageAnalysis} ${error.message}`;
        if (elements.koreanAnalysisResultDiv) elements.koreanAnalysisResultDiv.textContent = "";
        if (elements.analysisModal) {
            elements.analysisModal.classList.remove('hidden');
            elements.analysisModal.classList.add('fade-in');
        }
    } finally {
        appState.isLoadingAnalysis = false;
        setLoadingState('analyzeSentenceButton', '', false);
    }
}

function handleRoleSwap() {
    console.log("handleRoleSwap í˜¸ì¶œë¨");
    if (appState.isLoading) {
        alert(appState.UI_TEXT.scenarioChangeLoadingAlert);
        return;
    }
    appState.userIsPlayingPrimaryRole = !appState.userIsPlayingPrimaryRole;
    appState.currentMessages = [];
    renderMessages();
    saveConversationToLocal();
    clearInput('userInputElem');
    hideSuggestedReplies();
    closeAnalysisModal();
    updateScenarioDisplay(false);

    const currentRoleDescription = appState.userIsPlayingPrimaryRole ?
        (appState.currentScenario.id === "custom" ? 'ì§ì ‘ ì…ë ¥í•œ ìƒí™©ì˜ ì£¼ìš”í•œ ì—­í• ' : `"${appState.currentScenario.title}" ìƒí™©ì˜ ì£¼ìš”í•œ ì—­í•  (ì˜ˆ: ì†ë‹˜, í™˜ì)`) :
        (appState.currentScenario.id === "custom" ? 'ì§ì ‘ ì…ë ¥í•œ ìƒí™©ì˜ AIì˜ ì—­í• ' : `"${appState.currentScenario.title}" ìƒí™©ì˜ AIì˜ ì—­í•  (ì˜ˆ: ì ì›, ì˜ì‚¬)`);

    alert(appState.UI_TEXT.roleChangeAlert(currentRoleDescription));
}

function handleNewConversation() {
    console.log("handleNewConversation í˜¸ì¶œë¨");
    if (appState.isLoading) {
        alert(appState.UI_TEXT.newConversationLoadingAlert);
        return;
    }
    appState.currentMessages = [];
    renderMessages();
    clearInput('userInputElem');
    hideSuggestedReplies();
    closeAnalysisModal();
    appState.userIsPlayingPrimaryRole = true;
    updateScenarioDisplay(false);

    const scenarioTitleForAlert = appState.currentScenario.id === 'custom' ? (appState.currentCustomScenarioInput || appState.UI_TEXT.scenarioTitleCustom(appState.currentCustomScenarioInput)) : appState.currentScenario.title;
    alert(appState.UI_TEXT.newConversationAlert(scenarioTitleForAlert));
}

function handleScenarioSelect(scenarioItem) {
    console.log("handleScenarioSelect í˜¸ì¶œë¨:", scenarioItem);
    if (appState.isLoading) {
        alert(appState.UI_TEXT.scenarioChangeLoadingAlert);
        return;
    }
    const fullScenarioDetails = findScenarioById(scenarioItem.id);
    appState.currentScenario = fullScenarioDetails;
    appState.currentMessages = [];
    clearInput('userInputElem');
    hideSuggestedReplies();
    closeAnalysisModal();
    appState.userIsPlayingPrimaryRole = true;

    if (scenarioItem.id !== "custom") {
        appState.currentCustomScenarioInput = '';
        clearInput('customScenarioInputElem');
    } else {
        appState.currentFocusTopic = '';
        clearInput('focusTopicInput');
    }
    updateScenarioDisplay(false);
    renderMessages();
    saveConversationToLocal();
    toggleScenarioPicker();
}

function setLanguage(langCode) {
    console.log("setLanguage í˜¸ì¶œë¨:", langCode);
    if (!langPacks[langCode]) {
        console.error(`Unsupported language code: ${langCode}`);
        return;
    }

    appState.currentLangCode = langCode;
    appState.SCENARIO_DATA = langPacks[langCode].scenarios;
    appState.UI_TEXT = langPacks[langCode].ui;

    localStorage.setItem('speakup_ai_lang', langCode);

    updateAllButtonTexts();
    appState.currentScenario = findScenarioById(appState.currentScenario?.id || "cafe");
    if (!appState.currentScenario) {
         appState.currentScenario = findScenarioById("cafe");
    }
    updateScenarioDisplay(false);
    renderScenarioPicker();
    if (elements.currentLanguageDisplay) {
        elements.currentLanguageDisplay.textContent = langPacks[langCode].displayName;
    }
    if (elements.viewFavoritesButton) {
        elements.viewFavoritesButton.title = appState.UI_TEXT.viewFavoritesButtonTitle || "ì¦ê²¨ì°¾ê¸° ëª¨ì•„ë³´ê¸°";
    }
}

// --- ëª¨ë“ ì´ë²¤íŠ¸ë¦¬ìŠ¤ë„ˆì„¤ì •í•¨ìˆ˜ ---

function attachEventListeners() {
    console.log("attachEventListeners: ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²° ì‹œì‘");

    if (elements.scenarioPickerButton) {
        console.log("ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²°");
        elements.scenarioPickerButton.addEventListener('click', toggleScenarioPicker);
    }
    if (elements.newConversationButton) {
        console.log("ìƒˆ ëŒ€í™” ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²°");
        elements.newConversationButton.addEventListener('click', handleNewConversation);
    }
    if (elements.jsonMenuButton) {
        elements.jsonMenuButton.addEventListener('click', toggleJsonMenu);
    }
    if (elements.jsonMenuSave) {
        elements.jsonMenuSave.addEventListener('click', (e) => {
            e.preventDefault();
            exportConversationToJson();
            toggleJsonMenu();
        });
    }
    if (elements.jsonMenuLoad && elements.importJsonInput) {
        elements.jsonMenuLoad.addEventListener('click', (e) => {
            e.preventDefault();
            elements.importJsonInput.click();
        });
        elements.importJsonInput.addEventListener('change', (e) => {
            if (e.target.files && e.target.files[0]) {
                importConversationFromJson(e.target.files[0]);
                e.target.value = '';
            }
            toggleJsonMenu();
        });
    }
    // ì €ì¥ëœ ë°ì´í„° ë©”ë‰´ ë²„íŠ¼ ì´ë²¤íŠ¸
    if (elements.savedDataMenuButton) {
        console.log("ì €ì¥ëœ ë°ì´í„° ë©”ë‰´ ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²°");
        elements.savedDataMenuButton.addEventListener('click', toggleSavedDataMenu);
    }
    
    // ì €ì¥ëœ ë°ì´í„° ë©”ë‰´ ë“œë¡­ë‹¤ìš´ ë‚´ë¶€ ë²„íŠ¼ë“¤
    if (elements.savedDataMenuFavorites) {
        elements.savedDataMenuFavorites.addEventListener('click', function(e) {
            e.preventDefault();
            console.log("ì¦ê²¨ì°¾ê¸° ë©”ë‰´ í•­ëª© í´ë¦­ë¨");
            window.location.href = 'favorites.html';
        });
    }
    
    if (elements.savedDataMenuAnalyses) {
        elements.savedDataMenuAnalyses.addEventListener('click', function(e) {
            e.preventDefault();
            console.log("ì €ì¥ëœ ë¶„ì„ ë©”ë‰´ í•­ëª© í´ë¦­ë¨");
            window.location.href = 'analyses.html';
        });
    }
    if (elements.helpButton) {
        console.log("ë„ì›€ë§ ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²°");
        elements.helpButton.addEventListener('click', (event) => {
            event.stopPropagation();
            showGuideModal();
        });
    }

    if (elements.closeGuideModalButton) elements.closeGuideModalButton.addEventListener('click', closeGuideModal);
    if (elements.confirmGuideModalButton) elements.confirmGuideModalButton.addEventListener('click', closeGuideModal);
    
    // ì¦ê²¨ì°¾ê¸° ëª¨ë‹¬ ë‹«ê¸° ë²„íŠ¼ë“¤ - ì§ì ‘ ì—°ê²°
    const closeFavBtn = document.getElementById('closeFavoritesModalButton');
    const confirmFavBtn = document.getElementById('confirmFavoritesModalButton');
    if (closeFavBtn) closeFavBtn.addEventListener('click', closeFavoritesModal);
    if (confirmFavBtn) confirmFavBtn.addEventListener('click', closeFavoritesModal);
    
    // ë¶„ì„ ì €ì¥ ë° ì €ì¥ëœ ë¶„ì„ ëª¨ë‹¬ ë²„íŠ¼ë“¤ - ì§ì ‘ ì—°ê²°
    const saveAnalysisBtn = document.getElementById('saveAnalysisButton');
    const closeSavedAnalysesBtn = document.getElementById('closeSavedAnalysesModalButton');
    const confirmSavedAnalysesBtn = document.getElementById('confirmSavedAnalysesModalButton');
    
    if (saveAnalysisBtn) {
        saveAnalysisBtn.addEventListener('click', function() {
            console.log("ë¶„ì„ ì €ì¥ ë²„íŠ¼ í´ë¦­ë¨");
            saveCurrentAnalysis();
        });
    }
    if (closeSavedAnalysesBtn) closeSavedAnalysesBtn.addEventListener('click', closeSavedAnalysesModal);
    if (confirmSavedAnalysesBtn) confirmSavedAnalysesBtn.addEventListener('click', closeSavedAnalysesModal);

    if (elements.sendMessageButton) {
        console.log("ë©”ì‹œì§€ ì „ì†¡ ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²°");
        elements.sendMessageButton.addEventListener('click', handleSendMessage);
    }
    if (elements.userInputElem) {
        elements.userInputElem.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !appState.isLoading) {
                handleSendMessage();
            }
        });
    }
    if (elements.suggestRepliesButton) {
        console.log("ì‘ë‹µ ì œì•ˆ ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²°");
        elements.suggestRepliesButton.addEventListener('click', handleSuggestReplies);
    }
    if (elements.analyzeSentenceButton) {
        console.log("ë¬¸ì¥ ë¶„ì„ ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²°");
        elements.analyzeSentenceButton.addEventListener('click', handleAnalyzeSentence);
    }
    if (elements.roleSwapButton) {
        console.log("ì—­í•  ë³€ê²½ ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²°");
        elements.roleSwapButton.addEventListener('click', handleRoleSwap);
    }

    if (elements.messagesContainer) {
        elements.messagesContainer.addEventListener('click', (e) => {
            const btn = e.target.closest('.favorite-btn');
            if (btn && btn.dataset.index) {
                toggleFavorite(parseInt(btn.dataset.index, 10));
            }
        });
    }

    if (elements.closeAnalysisModalButtonFromAnalysis) elements.closeAnalysisModalButtonFromAnalysis.addEventListener('click', closeAnalysisModal);
    if (elements.confirmAnalysisModalButtonFromAnalysis) elements.confirmAnalysisModalButtonFromAnalysis.addEventListener('click', closeAnalysisModal);
    if (elements.closeFavoritesModalButton) elements.closeFavoritesModalButton.addEventListener('click', closeFavoritesModal);
    if (elements.confirmFavoritesModalButton) elements.confirmFavoritesModalButton.addEventListener('click', closeFavoritesModal);

    if (elements.focusTopicInput) elements.focusTopicInput.addEventListener('change', (e) => { appState.currentFocusTopic = e.target.value; });
    if (elements.customScenarioInputElem) elements.customScenarioInputElem.addEventListener('change', (e) => {
        appState.currentCustomScenarioInput = e.target.value;
        updateScenarioDisplay();
    });

    if (elements.languagePickerButton) {
        console.log("ì–¸ì–´ ì„ íƒ ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²°");
        elements.languagePickerButton.addEventListener('click', toggleLanguagePicker);
    }
    if (elements.languageDropdown) {
        elements.languageDropdown.addEventListener('click', (event) => {
            event.preventDefault();
            const target = event.target.closest('a');
            if (target && target.dataset.lang) {
                const langCode = target.dataset.lang;
                setLanguage(langCode);
                toggleLanguagePicker();
            }
        });
    }

    document.addEventListener('click', (event) => {
        if (elements.scenarioPickerContainer && !elements.scenarioPickerContainer.contains(event.target) && appState.showScenarioPicker) {
            toggleScenarioPicker();
        }
        if (elements.languagePickerContainer && !elements.languagePickerContainer.contains(event.target) && appState.showLanguagePicker) {
            toggleLanguagePicker();
        }
        if (elements.jsonMenuContainer && !elements.jsonMenuContainer.contains(event.target) && appState.showJsonMenu) {
            toggleJsonMenu();
        }
        if (elements.savedDataMenuContainer && !elements.savedDataMenuContainer.contains(event.target) && appState.showSavedDataMenu) {
            toggleSavedDataMenu();
        }
        if (elements.analysisModalContent && !elements.analysisModalContent.contains(event.target) &&
            elements.analysisModal && !elements.analysisModal.classList.contains('hidden')) {
            closeAnalysisModal();
        }
        if (elements.guideModalContent && !elements.guideModalContent.contains(event.target) &&
            elements.guideModal && !elements.guideModal.classList.contains('hidden')) {
            closeGuideModal();
        }
        if (elements.favoritesModalContent && !elements.favoritesModalContent.contains(event.target) &&
            elements.favoritesModal && !elements.favoritesModal.classList.contains('hidden')) {
            closeFavoritesModal();
        }
        if (elements.savedAnalysesModalContent && !elements.savedAnalysesModalContent.contains(event.target) &&
            elements.savedAnalysesModal && !elements.savedAnalysesModal.classList.contains('hidden')) {
            closeSavedAnalysesModal();
        }
    });
    console.log("attachEventListeners: ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²° ì™„ë£Œ");
}

// --- ì•±ì´ˆê¸°í™”ë¡œì§ ---
document.addEventListener('DOMContentLoaded', async () => {
    console.log("DOMContentLoaded: ì•± ì´ˆê¸°í™” ì‹œì‘");
    initDOMElements();
    attachEventListeners();

    const savedLang = localStorage.getItem('speakup_ai_lang') || 'ko';
    setLanguage(savedLang);

    appState.currentScenario = findScenarioById("cafe");

    updateScenarioDisplay(false);
    renderMessages();
    restoreConversationFromLocal();

    if (!localStorage.getItem(`guideShown_${APP_ID}`)) {
        showGuideModal();
    }
    console.log("DOMContentLoaded: ì•± ì´ˆê¸°í™” ì™„ë£Œ");
});
    </script>
</body>
</html>
